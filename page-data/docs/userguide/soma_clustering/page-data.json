{"componentChunkName":"component---src-templates-markdown-post-js","path":"/docs/userguide/soma_clustering/","webpackCompilationHash":"59ae1e0c7c5698c260ab","result":{"data":{"site":{"siteMetadata":{"siteUrl":"http://local:8000","title":"BioDynaMO Website","description":"Everything you need to know about biology simulations."}},"markdownRemark":{"frontmatter":{"title":"Soma Clustering","date":"2019-01-01","date_pretty":"01 January, 2019","path":"/docs/userguide/soma_clustering/","meta_title":"BioDynaMo User Guide","meta_description":"This is the soma clustering page.","image":"","next":{"url":"/docs/userguide/soma_clustering/","title":"Soma Clustering","description":"This is the soma clustering page."},"sidebar":"userguide","toc":true},"html":"<p>Let's take a look at a more realistic example called soma clustering. In this\nexample, we create two types of cells. Each type of cell secretes a specific substance,\nand moves along the gradient of its corresponding substance. This will form clusters\nof cells that are of the same type.</p>\n<h2 id=\"copy-out-the-demo-code\"><a href=\"#copy-out-the-demo-code\" aria-label=\"copy out the demo code permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Copy out the demo code</h2>\n<p>Soma clustering is one of many installed demos. It can be copied to a target directory:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">biodynamo demo soma_clustering <span class=\"token keyword\">.</span></code></pre></div>\n<h2 id=\"inspect-the-code\"><a href=\"#inspect-the-code\" aria-label=\"inspect the code permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Inspect the code</h2>\n<p>Go into the <code class=\"language-text\">soma_clustering</code> directory and open the source file <code class=\"language-text\">src/soma_clustering.h</code> in your favorite editor.\nWe can note the following things from its content:</p>\n<h3 id=\"1-creating-a-custom-simulation-object\"><a href=\"#1-creating-a-custom-simulation-object\" aria-label=\"1 creating a custom simulation object permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Creating a custom simulation object</h3>\n<p>In <code class=\"language-text\">src/my_cell.h</code> we can find the following code:</p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyCell</span> <span class=\"token operator\">:</span> <span class=\"token keyword\">public</span> Cell <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">BDM_SIM_OBJECT_HEADER</span><span class=\"token punctuation\">(</span>MyCell<span class=\"token punctuation\">,</span> Cell<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> cell_type_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n <span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\n  <span class=\"token function\">MyCell</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token function\">MyCell</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> Double3<span class=\"token operator\">&amp;</span> position<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token function\">Base</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">void</span> <span class=\"token function\">SetCellType</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> t<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> cell_type_ <span class=\"token operator\">=</span> t<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">int</span> <span class=\"token function\">GetCellType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> cell_type_<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n\n <span class=\"token keyword\">private</span><span class=\"token operator\">:</span>\n  <span class=\"token keyword\">int</span> cell_type_<span class=\"token punctuation\">;</span></code></pre></div>\n<p>We create a new type of cell called \"MyCell\" that extends the default Cell.\nIt contains a new data member called <code class=\"language-text\">cell_type_</code> that makes it possible to assign\na type to a cell.</p>\n<h3 id=\"2-define-substances-and-biology-modules\"><a href=\"#2-define-substances-and-biology-modules\" aria-label=\"2 define substances and biology modules permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Define substances and biology modules</h3>\n<p>In <code class=\"language-text\">src/soma_clustering_biology_modules.h</code> we can find the listing of the two substances\nthat are used in this simulation:</p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">enum</span> <span class=\"token class-name\">Substances</span> <span class=\"token punctuation\">{</span> kSubstance_0<span class=\"token punctuation\">,</span> kSubstance_1 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>We can also find the biology modules that were used in the Diffusion exercise.</p>\n<h2 id=\"configure-the-simulation\"><a href=\"#configure-the-simulation\" aria-label=\"configure the simulation permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Configure the simulation</h2>\n<p>Create a <code class=\"language-text\">bdm.toml</code> file in the <code class=\"language-text\">diffusion</code> directory, and create the following\nconfiguration file:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[visualization]\nexport = true\nexport_interval = 10\n\n\t[[visualize_sim_object]]\n\tname = &quot;MyCell&quot;\n\tadditional_data_members = [ &quot;diameter_&quot;, &quot;cell_type_&quot; ]\n\n\t[[visualize_diffusion]]\n\tname = &quot;Substance_0&quot;\n\n  [[visualize_diffusion]]\n  name = &quot;Substance_1&quot;</code></pre></div>\n<p>This will enable exporting visualization files, so that we can visualize the\nsimulation after it has finished. Furthermore, we enable the output of the diameter\nand the cell type of our simulation objects (named \"MyCell\"), and the two substances\nthat are secreted.</p>\n<h2 id=\"build-and-run-the-simulation\"><a href=\"#build-and-run-the-simulation\" aria-label=\"build and run the simulation permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Build and run the simulation</h2>\n<p>Run the following commands to build and run the simulation (do not forget to\n<code class=\"language-text\">biodynamo source</code> if you haven't already in your terminal):</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">biodynamo build\nbiodynamo run</code></pre></div>\n<h2 id=\"visualize-the-simulation\"><a href=\"#visualize-the-simulation\" aria-label=\"visualize the simulation permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Visualize the simulation</h2>\n<p>Open ParaView and navigate to the <code class=\"language-text\">diffusion</code> directory. Open the <code class=\"language-text\">cells_data_*</code>\nand <code class=\"language-text\">Kalium_*</code> files as Group (see the Visualization exercise as a reference).</p>\n<p>Click on the <code class=\"language-text\">cells_data_</code> entry in the Pipeline Browser. From \"Filters\", select\n\"Search\" (or do Ctrl + Space). Search for the \"Glyph\" filter, Apply it, and set\nthe following properties:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Glyph Type \t\t<span class=\"token operator\">=</span> <span class=\"token string\">'Sphere'</span>\nScalars \t\t  <span class=\"token operator\">=</span> <span class=\"token string\">'Diameters'</span>\nScale Mode \t\t<span class=\"token operator\">=</span> <span class=\"token string\">'Scalar'</span>\nScale Factor \t<span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nGlyph Mode \t\t<span class=\"token operator\">=</span> <span class=\"token string\">'All Points'</span></code></pre></div>\n<p>And hit Apply. You might need to 'Zoom to Fit'. Hit the Play button on the top of\nthe interface to play the simulation over time.</p>","fields":{"slug":"/docs/userguide/soma_clustering/"},"timeToRead":2,"excerpt":"Let's take a look at a more realistic example called soma clustering. In this\nexample, we create two types of cells. Each type of cell…","fileAbsolutePath":"/website/content/biodynamo/doc/user_guide/soma_clustering.md"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/docs/userguide/soma_clustering/"}}}
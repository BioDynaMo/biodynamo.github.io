var hbs = require('express-hbs');
var path = require('path');

hbs.registerHelper('icon', function (name, options) {
    var partial;
    if (name === undefined) {
        // TODO: Make this a proper log
        // console.error('TEMPLATE ERROR: Icon name must be a string in quotes');
        return;
    }

    partial = hbs.handlebars.partials[path.join('icons', name)];

    if (partial === undefined) {
        // TODO: Make this a proper log
        // console.error('TEMPLATE ERROR: Icon ' + name + ' could not be found');
        return;
    }

    // If the partial view is not compiled, it compiles and saves in handlebars
    if (typeof partial === 'string') {
        hbs.registerPartial(partial);
    }

    return new hbs.handlebars.SafeString(partial(options.hash || {}));
});

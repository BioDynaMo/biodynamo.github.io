'use strict';

const hbs = require('express-hbs');
const linkStyles = require('./styles/link');

hbs.registerHelper('gh-link-to', function (href, options) {
    let styles = linkStyles({
        class: options.hash.class,
        icon: options.hash.icon,
        style: options.hash.style
    });

    let attrs = Object.keys(options.hash).map((key) => {
        if (key !== 'style' && key !== 'class') {
            return `${key}="${options.hash[key]}"`;
        }
    }).join(' ');

    return new hbs.handlebars.SafeString(
        `<a href="${href}" class="${styles.link}" ${attrs}>` + (styles.span !== '' ? `<span class="${styles.span}">` : ``)
        + options.fn(this)
        + (styles.span !== '' ? `</span>` : ``) + `</a>`
    );
});

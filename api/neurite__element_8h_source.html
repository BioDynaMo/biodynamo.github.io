<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>BioDynaMo: neuroscience/neurite_element.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BioDynaMo
   &#160;<span id="projectnumber">v0.1.0-113-g5893954</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('neurite__element_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">neurite_element.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="neurite__element_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Copyright (C) The BioDynaMo Project.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// All Rights Reserved.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// you may not use this file except in compliance with the License.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// See the LICENSE file distributed with this work for details.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// See the NOTICE file distributed with this work for additional information</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// regarding copyright ownership.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#ifndef NEUROSCIENCE_NEURITE_ELEMENT_H_</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define NEUROSCIENCE_NEURITE_ELEMENT_H_</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;set&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;unordered_map&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="biology__module__util_8h.html">biology_module_util.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="default__force_8h.html">default_force.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="log_8h.html">log.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="math__util_8h.html">math_util.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="neurite__bifurcation__event_8h.html">neuroscience/event/neurite_bifurcation_event.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="neurite__branching__event_8h.html">neuroscience/event/neurite_branching_event.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="new__neurite__extension__event_8h.html">neuroscience/event/new_neurite_extension_event.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="side__neurite__extension__event_8h.html">neuroscience/event/side_neurite_extension_event.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="split__neurite__element__event_8h.html">neuroscience/event/split_neurite_element_event.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="neuroscience_2param_8h.html">neuroscience/param.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="random_8h.html">random.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="shape_8h.html">shape.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="simulation__object_8h.html">simulation_object.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="simulation__object__util_8h.html">simulation_object_util.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">namespace </span>bdm {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">namespace </span>experimental {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">namespace </span>neuroscience {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> TNeuronSomaSoPtr, <span class="keyword">typename</span> TNeuriteElementSoPtr&gt;</div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">   49</a></span>&#160;<span class="keyword">class </span><a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">NeuronNeuriteAdapter</a> {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a85e7c4fec34cd9b3d0f57002cc63f4bd">   51</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">Self</a> = <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">NeuronNeuriteAdapter&lt;TNeuronSomaSoPtr, TNeuriteElementSoPtr&gt;</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a6186b4d8f398e88f424a6fa7993d3b7c">   53</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a6186b4d8f398e88f424a6fa7993d3b7c">NeuronNeuriteAdapter</a>() {}</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a8f653135ca75fab17dbd966cb83a4a75">   56</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a8f653135ca75fab17dbd966cb83a4a75">NeuronNeuriteAdapter</a>(  <span class="comment">// NOLINT</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      T&amp;&amp; soptr,</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keyword">typename</span> std::enable_if&lt;is_same&lt;T, TNeuronSomaSoPtr&gt;::value&gt;::type* p =</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;          0) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0c63c0fb4e2ba6cba9b285d40f728b38">neuron_ptr_</a> = soptr;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a1a1a30f2d46dbd50f3ddab29825a93bb">   64</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a1a1a30f2d46dbd50f3ddab29825a93bb">NeuronNeuriteAdapter</a>(  <span class="comment">// NOLINT</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      T&amp;&amp; soptr,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keyword">typename</span> std::enable_if&lt;is_same&lt;T, TNeuriteElementSoPtr&gt;::value&gt;::type*</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          p = 0) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">neurite_ptr_</a> = soptr;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a77a590be0976ceb0b0dce335b973b0f3">   72</a></span>&#160;  <span class="keyword">typename</span> std::enable_if&lt;is_same&lt;T, TNeuronSomaSoPtr&gt;::value&gt;::type <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a77a590be0976ceb0b0dce335b973b0f3">Set</a>(</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      T&amp;&amp; soptr) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0c63c0fb4e2ba6cba9b285d40f728b38">neuron_ptr_</a> = soptr;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#aa6a1add571cae1ffb1271efa9af3d40f">   78</a></span>&#160;  <span class="keyword">typename</span> std::enable_if&lt;is_same&lt;T, TNeuriteElementSoPtr&gt;::value&gt;::type <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#aa6a1add571cae1ffb1271efa9af3d40f">Set</a>(</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      T&amp;&amp; soptr) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">neurite_ptr_</a> = soptr;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0d243d8c61c7c199f25bee0e217c4bdf">   83</a></span>&#160;  <span class="keyword">const</span> TNeuronSomaSoPtr&amp; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0d243d8c61c7c199f25bee0e217c4bdf">GetNeuronSomaSoPtr</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0c63c0fb4e2ba6cba9b285d40f728b38">neuron_ptr_</a>; }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ae00e139f23595f2982c63f7d9e982211">   85</a></span>&#160;  <span class="keyword">const</span> TNeuriteElementSoPtr&amp; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ae00e139f23595f2982c63f7d9e982211">GetNeuriteElementSoPtr</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">neurite_ptr_</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0854c74881648c1a6dddfd5705afb125">   89</a></span>&#160;  TNeuronSomaSoPtr&amp; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0854c74881648c1a6dddfd5705afb125">GetNeuronSomaSoPtr</a>() { <span class="keywordflow">return</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0c63c0fb4e2ba6cba9b285d40f728b38">neuron_ptr_</a>; }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ab0bd41618aeeeee2bc5053b4f9cadad5">   91</a></span>&#160;  TNeuriteElementSoPtr&amp; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ab0bd41618aeeeee2bc5053b4f9cadad5">GetNeuriteElementSoPtr</a>() { <span class="keywordflow">return</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">neurite_ptr_</a>; }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a43078567816b252638799bae180c2af7">   93</a></span>&#160;  <span class="keyword">const</span> std::array&lt;double, 3&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a43078567816b252638799bae180c2af7">GetPosition</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ae2ffe7cc3a2c157cda3cbd2819f3a6d1">IsNeuriteElement</a>()) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">neurite_ptr_</a>-&gt;GetPosition();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    assert(<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a8f555cd029b6589ed3d15a54fa729ba3">IsNeuronSoma</a>() &amp;&amp;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;           <span class="stringliteral">&quot;Initialization error: neither neuron nor neurite&quot;</span>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0c63c0fb4e2ba6cba9b285d40f728b38">neuron_ptr_</a>-&gt;GetPosition();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a7fa9dce9c4313fbfb1a638dca4fe5a44">  102</a></span>&#160;  std::array&lt;double, 3&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a7fa9dce9c4313fbfb1a638dca4fe5a44">OriginOf</a>(uint32_t daughter_element_idx)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ae2ffe7cc3a2c157cda3cbd2819f3a6d1">IsNeuriteElement</a>()) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">neurite_ptr_</a>-&gt;OriginOf(daughter_element_idx);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    assert(<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a8f555cd029b6589ed3d15a54fa729ba3">IsNeuronSoma</a>() &amp;&amp;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;           <span class="stringliteral">&quot;Initialization error: neither neuron nor neurite&quot;</span>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0c63c0fb4e2ba6cba9b285d40f728b38">neuron_ptr_</a>-&gt;OriginOf(daughter_element_idx);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a8f555cd029b6589ed3d15a54fa729ba3">  111</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a8f555cd029b6589ed3d15a54fa729ba3">IsNeuronSoma</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0c63c0fb4e2ba6cba9b285d40f728b38">neuron_ptr_</a> != <span class="keyword">nullptr</span>; }</div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ae2ffe7cc3a2c157cda3cbd2819f3a6d1">  112</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ae2ffe7cc3a2c157cda3cbd2819f3a6d1">IsNeuriteElement</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">neurite_ptr_</a> != <span class="keyword">nullptr</span>; }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="comment">// TODO(neurites) LB reference?</span></div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#aa266f923a7de5cd15fc4194f2ebb5368">  115</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">Self</a> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#aa266f923a7de5cd15fc4194f2ebb5368">GetMother</a>() {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    assert(<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ae2ffe7cc3a2c157cda3cbd2819f3a6d1">IsNeuriteElement</a>() &amp;&amp;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;           <span class="stringliteral">&quot;This function call is only allowed for a NeuriteElement&quot;</span>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">neurite_ptr_</a>-&gt;GetMother();</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a3a7f8c6d3f6123d803fb665c678f0c12">  121</a></span>&#160;  <span class="keyword">auto</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a3a7f8c6d3f6123d803fb665c678f0c12">GetDaughterLeft</a>() -&gt; decltype(</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      std::declval&lt;TNeuriteElementSoPtr&gt;()-&gt;<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a3a7f8c6d3f6123d803fb665c678f0c12">GetDaughterLeft</a>())<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    assert(<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ae2ffe7cc3a2c157cda3cbd2819f3a6d1">IsNeuriteElement</a>() &amp;&amp;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;           <span class="stringliteral">&quot;This function call is only allowed for a NeuriteElement&quot;</span>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">neurite_ptr_</a>-&gt;GetDaughterLeft();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a43b27f25de413303e3eafd205d87c8bb">  128</a></span>&#160;  <span class="keyword">auto</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a43b27f25de413303e3eafd205d87c8bb">GetDaughterRight</a>() -&gt; decltype(</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      std::declval&lt;TNeuriteElementSoPtr&gt;()-&gt;<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a43b27f25de413303e3eafd205d87c8bb">GetDaughterRight</a>())<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    assert(<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ae2ffe7cc3a2c157cda3cbd2819f3a6d1">IsNeuriteElement</a>() &amp;&amp;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;           <span class="stringliteral">&quot;This function call is only allowed for a NeuriteElement&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">neurite_ptr_</a>-&gt;GetDaughterRight();</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a5301b6d222ab297546f079f5617917f2">  135</a></span>&#160;  <span class="keyword">auto</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a5301b6d222ab297546f079f5617917f2">GetRestingLength</a>() -&gt; decltype(</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      std::declval&lt;TNeuriteElementSoPtr&gt;()-&gt;<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a5301b6d222ab297546f079f5617917f2">GetRestingLength</a>())<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    assert(<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ae2ffe7cc3a2c157cda3cbd2819f3a6d1">IsNeuriteElement</a>() &amp;&amp;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;           <span class="stringliteral">&quot;This function call is only allowed for a NeuriteElement&quot;</span>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">neurite_ptr_</a>-&gt;GetRestingLength();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ad6f82c4911cbdcdbe927ef69ee829458">  142</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ad6f82c4911cbdcdbe927ef69ee829458">UpdateDependentPhysicalVariables</a>() {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ae2ffe7cc3a2c157cda3cbd2819f3a6d1">IsNeuriteElement</a>()) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">neurite_ptr_</a>-&gt;UpdateDependentPhysicalVariables();</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    assert(<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a8f555cd029b6589ed3d15a54fa729ba3">IsNeuronSoma</a>() &amp;&amp;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;           <span class="stringliteral">&quot;Initialization error: neither neuron nor neurite&quot;</span>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0c63c0fb4e2ba6cba9b285d40f728b38">neuron_ptr_</a>-&gt;UpdateVolume();</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TNeuronOrNeurite&gt;</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ad223eb0b69f2258c580934acf4f89915">  153</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ad223eb0b69f2258c580934acf4f89915">UpdateRelative</a>(<span class="keyword">const</span> TNeuronOrNeurite&amp; old_rel,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                      <span class="keyword">const</span> TNeuronOrNeurite&amp; new_rel) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ae2ffe7cc3a2c157cda3cbd2819f3a6d1">IsNeuriteElement</a>()) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">neurite_ptr_</a>-&gt;UpdateRelative(old_rel, new_rel);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// TODO(neurites) improve</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keyword">auto</span> old_neurite_soptr = old_rel.GetNeuriteElementSoPtr();</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keyword">auto</span> new_neurite_soptr = new_rel.GetNeuriteElementSoPtr();</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    assert(<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a8f555cd029b6589ed3d15a54fa729ba3">IsNeuronSoma</a>() &amp;&amp;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;           <span class="stringliteral">&quot;Initialization error: neither neuron nor neurite&quot;</span>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0c63c0fb4e2ba6cba9b285d40f728b38">neuron_ptr_</a>-&gt;UpdateRelative(old_neurite_soptr, new_neurite_soptr);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a549b8747c20cad1ac5820f52e5bcc182">  167</a></span>&#160;  <span class="keyword">auto</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a549b8747c20cad1ac5820f52e5bcc182">RemoveFromSimulation</a>() -&gt; decltype(</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      std::declval&lt;TNeuriteElementSoPtr&gt;()-&gt;<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a549b8747c20cad1ac5820f52e5bcc182">RemoveFromSimulation</a>())<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    assert(<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ae2ffe7cc3a2c157cda3cbd2819f3a6d1">IsNeuriteElement</a>() &amp;&amp;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;           <span class="stringliteral">&quot;This function call is only allowed for a NeuriteElement&quot;</span>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">neurite_ptr_</a>-&gt;RemoveFromSimulation();</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ac4ebc1b8d47e2e672e6e977b640b477e">  174</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ac4ebc1b8d47e2e672e6e977b640b477e">RemoveDaughter</a>(<span class="keyword">const</span> TNeuriteElementSoPtr&amp; mother) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ae2ffe7cc3a2c157cda3cbd2819f3a6d1">IsNeuriteElement</a>()) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">neurite_ptr_</a>-&gt;RemoveDaughter(mother);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    assert(<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a8f555cd029b6589ed3d15a54fa729ba3">IsNeuronSoma</a>() &amp;&amp;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;           <span class="stringliteral">&quot;Initialization error: neither neuron nor neurite&quot;</span>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0c63c0fb4e2ba6cba9b285d40f728b38">neuron_ptr_</a>-&gt;RemoveDaughter(mother);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a3e9c79802e9f3aec60e79cf1b6eb303e">  184</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a3e9c79802e9f3aec60e79cf1b6eb303e">operator==</a>(</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keyword">const</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">NeuronNeuriteAdapter&lt;TNeuronSomaSoPtr, TNeuriteElementSoPtr&gt;</a> other)<span class="keyword"></span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="keyword">      const </span>{</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0c63c0fb4e2ba6cba9b285d40f728b38">neuron_ptr_</a> == other.<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0c63c0fb4e2ba6cba9b285d40f728b38">neuron_ptr_</a> &amp;&amp;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;           <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">neurite_ptr_</a> == other.<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">neurite_ptr_</a>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#acab0dd47ad027a139541a431f9e2b184">  191</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#acab0dd47ad027a139541a431f9e2b184">operator!=</a>(</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keyword">const</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">NeuronNeuriteAdapter&lt;TNeuronSomaSoPtr, TNeuriteElementSoPtr&gt;</a> other)<span class="keyword"></span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="keyword">      const </span>{</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">return</span> !(*<span class="keyword">this</span> == other);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0c63c0fb4e2ba6cba9b285d40f728b38">  198</a></span>&#160;  TNeuronSomaSoPtr <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0c63c0fb4e2ba6cba9b285d40f728b38">neuron_ptr_</a>;</div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">  199</a></span>&#160;  TNeuriteElementSoPtr <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">neurite_ptr_</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;};</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="namespacebdm_1_1experimental_1_1neuroscience.html#a3c2363340cba2f67f9124aae81cdc7d3">  216</a></span>&#160;<a class="code" href="simulation__object__util_8h.html#a1b9f7ea7c3d696427b4d429ff4dd6bab">BDM_SIM_OBJECT</a>(<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html">NeuriteElement</a>, <a class="code" href="classbdm_1_1SimulationObject.html">bdm::SimulationObject</a>) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <a class="code" href="simulation__object__util_8h.html#a6101b2c5b86a3594bbeaf078b35961f4">BDM_SIM_OBJECT_HEADER</a>(</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html">NeuriteElementExt</a>, 1, biology_modules_, mass_location_, volume_,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      diameter_, density_, adherence_, x_axis_, y_axis_, z_axis_, box_idx_,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      is_axon_, mother_, daughter_left_, daughter_right_, branch_order_,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      force_to_transmit_to_proximal_mass_, spring_axis_, actual_length_,</div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">  222</a></span>&#160;      tension_, spring_constant_, resting_length_);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa0e661c70c491f8eb0d532e69239c911">  225</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa0e661c70c491f8eb0d532e69239c911">NeuronSoma</a> = <span class="keyword">typename</span> <a class="code" href="namespacebdm_1_1experimental_1_1neuroscience.html#a19a8647c1380b168f90512da31ce4754">TCompileTimeParam::NeuronSoma</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ad5abc8dfbb03c46e1d5ed5461e08bf47">  226</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classbdm_1_1SoPointer.html">NeuronSomaSoPtr</a> = <a class="code" href="classbdm_1_1SoPointer.html">ToSoPtr&lt;NeuronSoma&gt;</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keyword">using</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">NeuriteOrNeuron</a> =</div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a44ec5cf3a0a8b24ef42e99cc72ddb9ca">  229</a></span>&#160;      <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">NeuronNeuriteAdapter&lt;ToSoPtr&lt;NeuronSoma&gt;</a>, <a class="code" href="classbdm_1_1SoPointer.html">MostDerivedSoPtr</a>&gt;;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a24a25778874592e4af2020f5e5a0d2a0">  233</a></span>&#160;  <span class="keyword">static</span> std::set&lt;std::string&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a24a25778874592e4af2020f5e5a0d2a0">GetRequiredVisDataMembers</a>() {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">return</span> {<span class="stringliteral">&quot;mass_location_&quot;</span>, <span class="stringliteral">&quot;diameter_&quot;</span>, <span class="stringliteral">&quot;actual_length_&quot;</span>, <span class="stringliteral">&quot;spring_axis_&quot;</span>};</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a2b0613ab32a1dc9d6e96c50ff53b8205">  237</a></span>&#160;  <span class="keyword">static</span> constexpr <a class="code" href="namespacebdm.html#a3037f55bcb7f13fc1580dfb578dec3ee">Shape</a> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a2b0613ab32a1dc9d6e96c50ff53b8205">GetShape</a>() { <span class="keywordflow">return</span> <a class="code" href="namespacebdm.html#a3037f55bcb7f13fc1580dfb578dec3eea3069b5d7175aff08def5caa5266f8055">kCylinder</a>; }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div>
<div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#afbebe406dcc221de6c35bda76510f315">  239</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#afbebe406dcc221de6c35bda76510f315">NeuriteElementExt</a>() {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keyword">auto</span>* param = Simulation_t::GetActive()-&gt;GetParam();</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    tension_[kIdx] = param-&gt;neurite_default_tension_;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    diameter_[kIdx] = param-&gt;neurite_default_diameter_;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    actual_length_[kIdx] = param-&gt;neurite_default_actual_length_;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    density_[kIdx] = param-&gt;neurite_default_density_;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    spring_constant_[kIdx] = param-&gt;neurite_default_spring_constant_;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    adherence_[kIdx] = param-&gt;neurite_default_adherence_;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TNeuronSoma&gt;</div>
<div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a84f1daf8ec532e814d0b6feedf59ad75">  254</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a84f1daf8ec532e814d0b6feedf59ad75">NeuriteElementExt</a>(<span class="keyword">const</span> <a class="code" href="structbdm_1_1experimental_1_1neuroscience_1_1NewNeuriteExtensionEvent.html">NewNeuriteExtensionEvent</a>&amp; event, TNeuronSoma* soma,</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                    uint64_t new_oid = 0) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keyword">auto</span>* param = Simulation_t::GetActive()-&gt;GetParam();</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    tension_[kIdx] = param-&gt;neurite_default_tension_;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    diameter_[kIdx] = param-&gt;neurite_default_diameter_;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    actual_length_[kIdx] = param-&gt;neurite_default_actual_length_;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    density_[kIdx] = param-&gt;neurite_default_density_;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    spring_constant_[kIdx] = param-&gt;neurite_default_spring_constant_;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    adherence_[kIdx] = param-&gt;neurite_default_adherence_;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordtype">double</span> diameter = <span class="keyword">event</span>.diameter_;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordtype">double</span> phi = <span class="keyword">event</span>.phi_;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">double</span> theta = <span class="keyword">event</span>.theta_;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keyword">auto</span>&amp; soma_bms = soma-&gt;biology_modules_[soma-&gt;kIdx];</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">// copy biology_modules_ to me</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keyword">auto</span>&amp; my_bms = biology_modules_[kIdx];</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <a class="code" href="namespacebdm.html#a4c062c6bcddf1e43dd406a65cfa451eb">CopyBiologyModules</a>(event, &amp;soma_bms, &amp;my_bms);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordtype">double</span> radius = 0.5 * soma-&gt;GetDiameter();</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordtype">double</span> new_length = param-&gt;neurite_default_actual_length_;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">// position in bdm.cells coord</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordtype">double</span> x_coord = std::sin(theta) * std::cos(phi);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordtype">double</span> y_coord = std::sin(theta) * std::sin(phi);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordtype">double</span> z_coord = std::cos(theta);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    std::array&lt;double, 3&gt; axis_direction{</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        x_coord * soma-&gt;kXAxis[0] + y_coord * soma-&gt;kYAxis[0] +</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            z_coord * soma-&gt;kZAxis[0],</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        x_coord * soma-&gt;kXAxis[1] + y_coord * soma-&gt;kYAxis[1] +</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            z_coord * soma-&gt;kZAxis[1],</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        x_coord * soma-&gt;kXAxis[2] + y_coord * soma-&gt;kYAxis[2] +</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            z_coord * soma-&gt;kZAxis[2]};</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// positions &amp; axis in cartesian coord</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keyword">auto</span> new_begin_location = <a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        soma-&gt;GetPosition(), <a class="code" href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">Math::ScalarMult</a>(radius, axis_direction));</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keyword">auto</span> new_spring_axis = <a class="code" href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">Math::ScalarMult</a>(new_length, axis_direction);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keyword">auto</span> new_mass_location = <a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(new_begin_location, new_spring_axis);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">// set attributes of new neurite segment</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    diameter_[kIdx] = diameter;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    UpdateVolume();</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    spring_axis_[kIdx] = new_spring_axis;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    SetMassLocation(new_mass_location);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    actual_length_[kIdx] = new_length;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    SetRestingLengthForDesiredTension(param-&gt;neurite_default_tension_);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    UpdateLocalCoordinateAxis();</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">// family relations</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    SetMother(soma-&gt;GetSoPtr());</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TNeuriteElement&gt;</div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a71cb0646e8ab51d3601a3526d56ec720">  318</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a71cb0646e8ab51d3601a3526d56ec720">NeuriteElementExt</a>(<span class="keyword">const</span> <a class="code" href="structbdm_1_1experimental_1_1neuroscience_1_1NeuriteBifurcationEvent.html">NeuriteBifurcationEvent</a>&amp; event,</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    TNeuriteElement* mother, uint64_t new_oid) {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keyword">auto</span>* param = Simulation_t::GetActive()-&gt;GetParam();</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    tension_[kIdx] = param-&gt;neurite_default_tension_;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    diameter_[kIdx] = param-&gt;neurite_default_diameter_;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    actual_length_[kIdx] = param-&gt;neurite_default_actual_length_;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    density_[kIdx] = param-&gt;neurite_default_density_;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    spring_constant_[kIdx] = param-&gt;neurite_default_spring_constant_;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    adherence_[kIdx] = param-&gt;neurite_default_adherence_;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">// detemine if we should create a left or right branch</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">// extract parameter from event</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordtype">double</span> length = <span class="keyword">event</span>.length_;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordtype">double</span> diameter;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    std::array&lt;double, 3&gt; direction;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">if</span> (new_oid == 0) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="comment">// left branch</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      diameter = <span class="keyword">event</span>.diameter_left_;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      direction = <span class="keyword">event</span>.direction_left_;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="comment">// right branch</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      diameter = <span class="keyword">event</span>.diameter_right_;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      direction = <span class="keyword">event</span>.direction_right_;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    Copy(*mother);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    SetMother(mother-&gt;GetSoPtr());</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// check that the directions are not pointing backwards</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keyword">auto</span> dir_1 = direction;  <span class="comment">// todo avoid cpy</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; mother_spring_axis = mother-&gt;GetSpringAxis();</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structbdm_1_1Math.html#aa8ecbf6af44a29c3f314ab97a1c53f20">Math::AngleRadian</a>(mother_spring_axis, direction) &gt; <a class="code" href="structbdm_1_1Math.html#a59ce6781aaf6ed4ee0c7648fd33f6b55">Math::kPi</a> / 2.0) {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keyword">auto</span> proj = <a class="code" href="structbdm_1_1Math.html#a9b542109de827309660950e8f5dee515">Math::ProjectionOnto</a>(direction, mother_spring_axis);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      proj = <a class="code" href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">Math::ScalarMult</a>(-1, proj);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      dir_1 = <a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(direction, proj);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// mass location and spring axis</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; mother_ml = mother-&gt;GetMassLocation();</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    SetSpringAxis(<a class="code" href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">Math::ScalarMult</a>(length, <a class="code" href="structbdm_1_1Math.html#a06cf62fd723d1775714117f3d42cc0d4">Math::Normalize</a>(dir_1)));</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    SetMassLocation(<a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(mother_ml, spring_axis_[kIdx]));</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    UpdateLocalCoordinateAxis();  <span class="comment">// (important so that x_axis_ is correct)</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// physics of tension :</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    actual_length_[kIdx] = length;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    SetRestingLengthForDesiredTension(param-&gt;neurite_default_tension_);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">// set local coordinate axis in the new branches</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">// TODO(neurites) again?? alreay done a few lines up</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    UpdateLocalCoordinateAxis();</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">// 2) creating the first daughter branch</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    diameter_[kIdx] = diameter;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    branch_order_[kIdx] = mother-&gt;GetBranchOrder() + 1;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// 4) the biological modules :</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keyword">auto</span>&amp; mother_bms = mother-&gt;biology_modules_[mother-&gt;kIdx];</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="comment">// copy biology_modules_ to me</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keyword">auto</span>&amp; my_bms = biology_modules_[kIdx];</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <a class="code" href="namespacebdm.html#a4c062c6bcddf1e43dd406a65cfa451eb">CopyBiologyModules</a>(event, &amp;mother_bms, &amp;my_bms);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    UpdateDependentPhysicalVariables();</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TNeuriteElement&gt;</div>
<div class="line"><a name="l00387"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a6f4153e0d6bdbcc171d50a57fc1d46f4">  387</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a6f4153e0d6bdbcc171d50a57fc1d46f4">NeuriteElementExt</a>(<span class="keyword">const</span> <a class="code" href="structbdm_1_1experimental_1_1neuroscience_1_1SideNeuriteExtensionEvent.html">SideNeuriteExtensionEvent</a>&amp; event,</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                    TNeuriteElement* mother, uint64_t new_oid = 0) {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    InitializeSideExtensionOrBranching(event, mother);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TNeuriteElement&gt;</div>
<div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a4817b3dce60fd516d4c1066d3c579e27">  397</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a4817b3dce60fd516d4c1066d3c579e27">NeuriteElementExt</a>(<span class="keyword">const</span> <a class="code" href="structbdm_1_1experimental_1_1neuroscience_1_1SplitNeuriteElementEvent.html">SplitNeuriteElementEvent</a>&amp; event,</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                    TNeuriteElement* other, uint64_t new_oid = 0) {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    InitializeSplitOrBranching(event, other);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TNeuriteElement&gt;</div>
<div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a86aeb3c31ce064028d44a564046e621b">  411</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a86aeb3c31ce064028d44a564046e621b">NeuriteElementExt</a>(<span class="keyword">const</span> <a class="code" href="structbdm_1_1experimental_1_1neuroscience_1_1NeuriteBranchingEvent.html">NeuriteBranchingEvent</a>&amp; event, TNeuriteElement* other,</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                    uint64_t new_oid) {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">if</span> (new_oid == 0) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      InitializeSplitOrBranching(event, other);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      InitializeSideExtensionOrBranching(event, other);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div>
<div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a35641e81dedc63e31e4ec29383d634bb">  423</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a35641e81dedc63e31e4ec29383d634bb">UpdateReferences</a>(</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keyword">const</span> std::vector&lt;std::unordered_map&lt;uint32_t, uint32_t&gt;&gt;&amp; update_info) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keyword">auto</span>* rm = Simulation_t::GetActive()-&gt;GetResourceManager();</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordtype">int</span> neurite_type_idx = rm-&gt;template GetTypeIndex&lt;MostDerivedScalar&gt;();</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; neurite_updates = update_info[neurite_type_idx];</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    this-&gt;UpdateReference(&amp;daughter_right_[kIdx], neurite_updates);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    this-&gt;UpdateReference(&amp;daughter_left_[kIdx], neurite_updates);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">if</span> (mother_[kIdx].IsNeuriteElement()) {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      this-&gt;UpdateReference(&amp;(mother_[kIdx].GetNeuriteElementSoPtr()),</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                            neurite_updates);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mother_[kIdx].IsNeuronSoma()) {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> neuron_type_idx = rm-&gt;template GetTypeIndex&lt;NeuronSoma&gt;();</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; neuron_updates = update_info[neuron_type_idx];</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      this-&gt;UpdateReference(&amp;(mother_[kIdx].GetNeuronSomaSoPtr()),</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                            neuron_updates);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ac8c264fb8344720469ca3bd59cba309a">  443</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ac8c264fb8344720469ca3bd59cba309a">SetDiameter</a>(<span class="keywordtype">double</span> diameter) {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    diameter_[kIdx] = diameter;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    UpdateVolume();</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#acd76dc3262056206791db0a0c3584c3a">  448</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#acd76dc3262056206791db0a0c3584c3a">SetDensity</a>(<span class="keywordtype">double</span> density) { density_[kIdx] = density; }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ae3fabe33f31d680ca046de2065b68a49">  450</a></span>&#160;  <span class="keyword">const</span> std::array&lt;double, 3&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ae3fabe33f31d680ca046de2065b68a49">GetPosition</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structbdm_1_1Math.html#a80c38cbb986a66639c5ff0ccfce5674e">Math::Subtract</a>(mass_location_[kIdx],</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                          <a class="code" href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">Math::ScalarMult</a>(0.5, spring_axis_[kIdx]));</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div>
<div class="line"><a name="l00455"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ae7979df2131be770f008fe0c4addb87d">  455</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ae7979df2131be770f008fe0c4addb87d">SetPosition</a>(<span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; position) {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    mass_location_[kIdx] =</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(position, <a class="code" href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">Math::ScalarMult</a>(0.5, spring_axis_[kIdx]));</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a6039e6d47bcd78dc27ac6ab67866a23c">  461</a></span>&#160;  <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a6039e6d47bcd78dc27ac6ab67866a23c">GetMassLocation</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">return</span> mass_location_[kIdx];</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div>
<div class="line"><a name="l00465"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ad4cd0147def1cd6706ebfaa95bccd9c3">  465</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ad4cd0147def1cd6706ebfaa95bccd9c3">SetMassLocation</a>(<span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; mass_location) {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    mass_location_[kIdx] = mass_location;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a933fd98f9bdc561fde5c3ce5fc9d70c0">  469</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a933fd98f9bdc561fde5c3ce5fc9d70c0">GetAdherence</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> adherence_[kIdx]; }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a95ae83512824f8a0235c6a1796d871a1">  471</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a95ae83512824f8a0235c6a1796d871a1">SetAdherence</a>(<span class="keywordtype">double</span> adherence) { adherence_[kIdx] = adherence; }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div>
<div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a732af732906c4a1c9050c6dd2725ffaf">  473</a></span>&#160;  <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a732af732906c4a1c9050c6dd2725ffaf">GetXAxis</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> x_axis_[kIdx]; }</div>
<div class="line"><a name="l00474"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a966e5f87a034b7c5f3d77b2fc5b332a4">  474</a></span>&#160;  <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a966e5f87a034b7c5f3d77b2fc5b332a4">GetYAxis</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> y_axis_[kIdx]; }</div>
<div class="line"><a name="l00475"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a7d64c264f1571f23dbf9c0bab7a37c5b">  475</a></span>&#160;  <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a7d64c264f1571f23dbf9c0bab7a37c5b">GetZAxis</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> z_axis_[kIdx]; }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div>
<div class="line"><a name="l00477"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#afe134e11979dae060b4c66fbf9d28dc9">  477</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#afe134e11979dae060b4c66fbf9d28dc9">GetVolume</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> volume_[kIdx]; }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a426f841fc5f81b40e36e759051c3b5c1">  479</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a426f841fc5f81b40e36e759051c3b5c1">GetDiameter</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> diameter_[kIdx]; }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa33c006b17130fd5e73767f659f3c24a">  481</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa33c006b17130fd5e73767f659f3c24a">GetDensity</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> density_[kIdx]; }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aaaf4aaa3a79e12dbb36b4ccf1b717dab">  483</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aaaf4aaa3a79e12dbb36b4ccf1b717dab">GetMass</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> density_[kIdx] * volume_[kIdx]; }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00485"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a50287c92165335f88ce50945e941a6c2">  485</a></span>&#160;  <a class="code" href="classbdm_1_1SoPointer.html">ToSoPtr&lt;NeuronSoma&gt;</a> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a50287c92165335f88ce50945e941a6c2">GetNeuronSomaOfNeurite</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keyword">auto</span> mother = mother_[kIdx];</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">while</span> (!mother.IsNeuronSoma()) {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      mother = mother.GetMother();</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">return</span> mother.GetNeuronSomaSoPtr();</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div>
<div class="line"><a name="l00493"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ae4542dab20ac7d818fa00f8ad345119c">  493</a></span>&#160;  uint64_t <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ae4542dab20ac7d818fa00f8ad345119c">GetBoxIdx</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> box_idx_[kIdx]; }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a93a7d26c797ad57f9173f63c92b6484c">  495</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a93a7d26c797ad57f9173f63c92b6484c">SetBoxIdx</a>(uint64_t idx) { box_idx_[kIdx] = idx; }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#afef33b19ea3f8c043f03605f9ebfa0d3">  501</a></span>&#160;  std::array&lt;double, 3&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#afef33b19ea3f8c043f03605f9ebfa0d3">OriginOf</a>(uint32_t daughter_element_idx)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">return</span> mass_location_[kIdx];</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keyword">using</span> BiologyModules =</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="keyword">typename</span> TCompileTimeParam::template CTMap&lt;MostDerivedScalar,</div>
<div class="line"><a name="l00507"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ac0328220b3487e1a5ef561336117065f">  507</a></span>&#160;                                                 0&gt;::BiologyModules::Variant_t;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TBiologyModule&gt;</div>
<div class="line"><a name="l00513"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a9f2bd88dfdacdc01c8f541e2309c4e19">  513</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a9f2bd88dfdacdc01c8f541e2309c4e19">AddBiologyModule</a>(TBiologyModule &amp;&amp; module) {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    biology_modules_[kIdx].emplace_back(module);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div>
<div class="line"><a name="l00518"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aac8c3a4ac11dcef1cbe20a7c567e614b">  518</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aac8c3a4ac11dcef1cbe20a7c567e614b">RunBiologyModules</a>() {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <a class="code" href="structbdm_1_1RunVisitor.html">RunVisitor&lt;MostDerived&lt;Backend&gt;</a>&gt; visitor(</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keyword">static_cast&lt;</span><a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aca6c5356ac82eb01a3796f256dabfb52">MostDerived&lt;Backend&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>));</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; module : biology_modules_[kIdx]) {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <a class="code" href="namespacebdm.html#a0afb3104a493a1bbe226d5d8941dedb6">visit</a>(visitor, module);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="comment">// TODO(neurites) arrange in order end</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="comment">// TODO(neurites) should be generated</span></div>
<div class="line"><a name="l00528"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ad9f2228c079b1fe0355637f354642e03">  528</a></span>&#160;  <span class="keywordtype">double</span>* <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ad9f2228c079b1fe0355637f354642e03">GetPositionPtr</a>() { <span class="keywordflow">return</span> &amp;(mass_location_[0][0]); }  <span class="comment">// FIXME</span></div>
<div class="line"><a name="l00529"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#afb2e0ba45705ceee528476c56db9a652">  529</a></span>&#160;  <span class="keywordtype">double</span>* <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#afb2e0ba45705ceee528476c56db9a652">GetDiameterPtr</a>() { <span class="keywordflow">return</span> &amp;(diameter_[0]); }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div>
<div class="line"><a name="l00546"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a6cf852c22bf3f671bea5b6a0a9a868e1">  546</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a6cf852c22bf3f671bea5b6a0a9a868e1">RetractTerminalEnd</a>(<span class="keywordtype">double</span> speed) {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">// check if is a terminal branch</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">if</span> (daughter_left_[kIdx] != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="comment">// scaling for integration step</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keyword">auto</span>* param = Simulation_t::GetActive()-&gt;GetParam();</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    speed *= param-&gt;simulation_time_step_;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">if</span> (actual_length_[kIdx] &gt; speed + 0.1) {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <span class="comment">// if actual_length_ &gt; length : retraction keeping the same tension</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="comment">// (putting a limit on how short a branch can be is absolutely necessary</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      <span class="comment">//  otherwise the tension might explode)</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="keywordtype">double</span> new_actual_length = actual_length_[kIdx] - speed;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="keywordtype">double</span> factor = new_actual_length / actual_length_[kIdx];</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      actual_length_[kIdx] = new_actual_length;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="comment">// cf removeproximalCylinder()</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      resting_length_[kIdx] = spring_constant_[kIdx] * actual_length_[kIdx] /</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                              (tension_[kIdx] + spring_constant_[kIdx]);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      spring_axis_[kIdx] = <a class="code" href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">Math::ScalarMult</a>(factor, spring_axis_[kIdx]);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      mass_location_[kIdx] = <a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;          mother_[kIdx].OriginOf(Base::GetElementIdx()), spring_axis_[kIdx]);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      UpdateVolume();  <span class="comment">// and update concentration of internal stuff.</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mother_[kIdx].IsNeuronSoma()) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      mother_[kIdx].RemoveDaughter(GetSoPtr());</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      RemoveFromSimulation();</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mother_[kIdx].IsNeuriteElement() &amp;&amp;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;               mother_[kIdx].GetDaughterRight() == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="comment">// if actual_length_ &lt; length and mother is a neurite element with no</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="comment">// other daughter : merge with mother</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      RemoveProximalNeuriteElement();  <span class="comment">// also updates volume_...</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      RetractTerminalEnd(speed / param-&gt;simulation_time_step_);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <span class="comment">// if mother is neurite element with other daughter or is not a neurite</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <span class="comment">// segment: disappear.</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      mother_[kIdx].RemoveDaughter(GetSoPtr());</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      RemoveFromSimulation();</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      mother_[kIdx].UpdateDependentPhysicalVariables();</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  }</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div>
<div class="line"><a name="l00598"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ac852537d04e2b5c8ecbc603f778295af">  598</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ac852537d04e2b5c8ecbc603f778295af">ElongateTerminalEnd</a>(<span class="keywordtype">double</span> speed,</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                           <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; direction) {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordtype">double</span> temp = <a class="code" href="structbdm_1_1Math.html#af3e942d1d0f43968c73c7b8cbba2725d">Math::Dot</a>(direction, spring_axis_[kIdx]);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordflow">if</span> (temp &gt; 0) {</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      MovePointMass(speed, direction);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00608"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aee4194da620ff39acfca04d6ccdc8029">  608</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aee4194da620ff39acfca04d6ccdc8029">BranchPermitted</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordflow">return</span> daughter_left_[kIdx] != <span class="keyword">nullptr</span> &amp;&amp; daughter_right_ == <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div>
<div class="line"><a name="l00615"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a42e85374e2c654a14c3131b8be168899">  615</a></span>&#160;  MostDerivedSoPtr <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a42e85374e2c654a14c3131b8be168899">Branch</a>(<span class="keywordtype">double</span> new_branch_diameter,</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                          <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; direction,</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                          <span class="keywordtype">double</span> length = 1.0) {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">// create a new neurite element for side branch</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="comment">// we first split this neurite element into two pieces</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="comment">// then append a &quot;daughter right&quot; between the two</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keyword">auto</span>* rm = Simulation_t::GetActive()-&gt;GetResourceManager();</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <a class="code" href="structbdm_1_1experimental_1_1neuroscience_1_1NeuriteBranchingEvent.html">NeuriteBranchingEvent</a> <span class="keyword">event</span> = {0.5, length, new_branch_diameter, direction};</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keyword">auto</span>&amp;&amp; proximal = rm-&gt;template New&lt;MostDerivedScalar&gt;(event, ThisMD(), 0);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keyword">auto</span>&amp;&amp; branch = rm-&gt;template New&lt;MostDerivedScalar&gt;(event, &amp;proximal, 1);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    ThisMD()-&gt;EventHandler(event, &amp;proximal, &amp;branch);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">return</span> branch.GetSoPtr();</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div>
<div class="line"><a name="l00633"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ad991b08ea5e0abb4698a6e46f4d18986">  633</a></span>&#160;  MostDerivedSoPtr <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ad991b08ea5e0abb4698a6e46f4d18986">Branch</a>(<span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; direction) {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">return</span> Branch(diameter_[kIdx], direction);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div>
<div class="line"><a name="l00641"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a627db0b6763c4d4843ae7fb2695d957d">  641</a></span>&#160;  MostDerivedSoPtr <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a627db0b6763c4d4843ae7fb2695d957d">Branch</a>(<span class="keywordtype">double</span> diameter) {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keyword">auto</span>* random = Simulation_t::GetActive()-&gt;GetRandom();</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keyword">auto</span> rand_noise = random-&gt;template UniformArray&lt;3&gt;(-0.1, 0.1);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keyword">auto</span> growth_direction =</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <a class="code" href="structbdm_1_1Math.html#a0295284d54dc8b78b7d981fefe373889">Math::Perp3</a>(<a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(GetUnitaryAxisDirectionVector(), rand_noise),</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                    random-&gt;Uniform(0, 1));</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    growth_direction = <a class="code" href="structbdm_1_1Math.html#a06cf62fd723d1775714117f3d42cc0d4">Math::Normalize</a>(growth_direction);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">return</span> Branch(diameter, growth_direction);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div>
<div class="line"><a name="l00656"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ac15587feb42d266325374dfc32f2b5b6">  656</a></span>&#160;  MostDerivedSoPtr <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ac15587feb42d266325374dfc32f2b5b6">Branch</a>() {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keyword">auto</span>* random = Simulation_t::GetActive()-&gt;GetRandom();</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordtype">double</span> branch_diameter = diameter_[kIdx];</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keyword">auto</span> rand_noise = random-&gt;template UniformArray&lt;3&gt;(-0.1, 0.1);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keyword">auto</span> growth_direction =</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <a class="code" href="structbdm_1_1Math.html#a0295284d54dc8b78b7d981fefe373889">Math::Perp3</a>(<a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(GetUnitaryAxisDirectionVector(), rand_noise),</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                    random-&gt;Uniform(0, 1));</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">return</span> Branch(branch_diameter, growth_direction);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div>
<div class="line"><a name="l00669"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a575a2efaec2afb3085e3d1feae2065ba">  669</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a575a2efaec2afb3085e3d1feae2065ba">BifurcationPermitted</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keyword">auto</span>* param = Simulation_t::GetActive()-&gt;GetParam();</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">return</span> (daughter_left_[kIdx] == <span class="keyword">nullptr</span> &amp;&amp;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            actual_length_[kIdx] &gt; param-&gt;neurite_minimial_bifurcation_length_);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div>
<div class="line"><a name="l00678"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a5034a8b639090e948131064c701bde46">  678</a></span>&#160;  std::array&lt;MostDerivedSoPtr, 2&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a5034a8b639090e948131064c701bde46">Bifurcate</a>(</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordtype">double</span> length, <span class="keywordtype">double</span> diameter_1, <span class="keywordtype">double</span> diameter_2,</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; direction_1,</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; direction_2) {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="comment">// 1) physical bifurcation</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="comment">// check it is a terminal branch</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">if</span> (daughter_left_[kIdx] != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      Fatal(<span class="stringliteral">&quot;NeuriteElements&quot;</span>,</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="stringliteral">&quot;Bifurcation only allowed on a terminal neurite element&quot;</span>);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keyword">auto</span>* rm = Simulation_t::GetActive()-&gt;GetResourceManager();</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="structbdm_1_1experimental_1_1neuroscience_1_1NeuriteBifurcationEvent.html">NeuriteBifurcationEvent</a> <span class="keyword">event</span> = {length, diameter_1, diameter_2,</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                                     direction_1, direction_2};</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keyword">auto</span>&amp;&amp; new_branch_l =</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        rm-&gt;template New&lt;MostDerivedScalar&gt;(event, ThisMD(), 0);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keyword">auto</span>&amp;&amp; new_branch_r =</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        rm-&gt;template New&lt;MostDerivedScalar&gt;(event, ThisMD(), 1);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    ThisMD()-&gt;EventHandler(event, &amp;new_branch_l, &amp;new_branch_r);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">return</span> {new_branch_l.GetSoPtr(), new_branch_r.GetSoPtr()};</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  std::array&lt;MostDerivedSoPtr, 2&gt; Bifurcate(</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      <span class="keywordtype">double</span> diameter_1, <span class="keywordtype">double</span> diameter_2,</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; direction_1,</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; direction_2);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00710"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa62110b09373e6f2f4933f3c0ebf6e07">  710</a></span>&#160;  std::array&lt;MostDerivedSoPtr, 2&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa62110b09373e6f2f4933f3c0ebf6e07">Bifurcate</a>(</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; direction_1,</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; direction_2) {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="comment">// initial default length :</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keyword">auto</span>* param = Simulation_t::GetActive()-&gt;GetParam();</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordtype">double</span> l = param-&gt;neurite_default_actual_length_;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">// diameters :</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordtype">double</span> d = diameter_[kIdx];</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">return</span> Bifurcate(l, d, d, direction_1, direction_2);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  }</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div>
<div class="line"><a name="l00724"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ab30cf0c7801228cd9b62ac3a71e0fa67">  724</a></span>&#160;  std::array&lt;MostDerivedSoPtr, 2&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ab30cf0c7801228cd9b62ac3a71e0fa67">Bifurcate</a>() {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="comment">// initial default length :</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keyword">auto</span>* param = Simulation_t::GetActive()-&gt;GetParam();</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordtype">double</span> l = param-&gt;neurite_default_actual_length_;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">// diameters :</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordtype">double</span> d = diameter_[kIdx];</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">// direction : (60 degrees between branches)</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keyword">auto</span>* random = Simulation_t::GetActive()-&gt;GetRandom();</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keywordtype">double</span> random_val = random-&gt;Uniform(0, 1);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keyword">auto</span> perp_plane = <a class="code" href="structbdm_1_1Math.html#a0295284d54dc8b78b7d981fefe373889">Math::Perp3</a>(spring_axis_[kIdx], random_val);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordtype">double</span> angle_between_branches = <a class="code" href="structbdm_1_1Math.html#a59ce6781aaf6ed4ee0c7648fd33f6b55">Math::kPi</a> / 3.0;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keyword">auto</span> direction_1 = <a class="code" href="structbdm_1_1Math.html#a39c5e7f5b49f38902ef63ae9f1215252">Math::RotAroundAxis</a>(</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        spring_axis_[kIdx], angle_between_branches * 0.5, perp_plane);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keyword">auto</span> direction_2 = <a class="code" href="structbdm_1_1Math.html#a39c5e7f5b49f38902ef63ae9f1215252">Math::RotAroundAxis</a>(</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        spring_axis_[kIdx], -angle_between_branches * 0.5, perp_plane);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">return</span> Bifurcate(l, d, d, direction_1, direction_2);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  }</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="comment">//      METHODS FOR NEURON TREE STRUCTURE *</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="comment">// TODO(neurites) documentation</span></div>
<div class="line"><a name="l00748"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a0e4ca0adcadf8411c5f393f269cb761f">  748</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a0e4ca0adcadf8411c5f393f269cb761f">RemoveDaughter</a>(<span class="keyword">const</span> MostDerivedSoPtr&amp; daughter) {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="comment">// If there is another daughter than the one we want to remove,</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="comment">// we have to be sure that it will be the daughterLeft-&gt;</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="keywordflow">if</span> (daughter == daughter_right_[kIdx]) {</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      daughter_right_[kIdx] = MostDerivedSoPtr();</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    }</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordflow">if</span> (daughter == daughter_left_[kIdx]) {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      daughter_left_[kIdx] = daughter_right_[kIdx];</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      daughter_right_[kIdx] = MostDerivedSoPtr();</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    Fatal(<span class="stringliteral">&quot;NeuriteElement&quot;</span>, <span class="stringliteral">&quot;Given object is not a daughter!&quot;</span>);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  }</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="comment">// TODO(neurites) add documentation</span></div>
<div class="line"><a name="l00765"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a76c39fd1d3a4fd43f999be9e7181c7ba">  765</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a76c39fd1d3a4fd43f999be9e7181c7ba">UpdateRelative</a>(<span class="keyword">const</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">NeuriteOrNeuron</a>&amp; old_relative,</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                      <span class="keyword">const</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">NeuriteOrNeuron</a>&amp; new_relative) {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordflow">if</span> (old_relative == mother_[kIdx]) {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      mother_[kIdx] = new_relative;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <span class="keyword">auto</span> old_neurite = old_relative.<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ae00e139f23595f2982c63f7d9e982211">GetNeuriteElementSoPtr</a>();</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <span class="keyword">auto</span> new_neurite = new_relative.<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ae00e139f23595f2982c63f7d9e982211">GetNeuriteElementSoPtr</a>();</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <span class="keywordflow">if</span> (old_neurite == daughter_left_[kIdx]) {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        daughter_left_[kIdx] = new_neurite;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (old_neurite == daughter_right_[kIdx]) {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        daughter_right_[kIdx] = new_neurite;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div>
<div class="line"><a name="l00783"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ab61966cfc922cada9e47fcc8e328deff">  783</a></span>&#160;  std::array&lt;double, 3&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ab61966cfc922cada9e47fcc8e328deff">ForceTransmittedFromDaugtherToMother</a>(</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="keyword">const</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">NeuriteOrNeuron</a>&amp; mother) {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">if</span> (mother_[kIdx] != mother) {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      Fatal(<span class="stringliteral">&quot;NeuriteElement&quot;</span>, <span class="stringliteral">&quot;Given object is not the mother!&quot;</span>);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="comment">// The inner tension is added to the external force that was computed</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="comment">// earlier.</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="comment">// (The reason for dividing by the actualLength is to normalize the</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="comment">// direction : T = T * axis/ (axis length)</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordtype">double</span> factor = tension_[kIdx] / actual_length_[kIdx];</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordflow">if</span> (factor &lt; 0) {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      factor = 0;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    }</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(<a class="code" href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">Math::ScalarMult</a>(factor, spring_axis_[kIdx]),</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                     force_to_transmit_to_proximal_mass_[kIdx]);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="comment">//   DISCRETIZATION , SPATIAL NODE, CELL ELEMENT</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div>
<div class="line"><a name="l00808"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#abb2a8a5f8566c5a87d75504dd1af2c98">  808</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#abb2a8a5f8566c5a87d75504dd1af2c98">RunDiscretization</a>() {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keyword">auto</span>* param = Simulation_t::GetActive()-&gt;GetParam();</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">if</span> (actual_length_[kIdx] &gt; param-&gt;neurite_max_length_) {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordflow">if</span> (daughter_left_[kIdx] == <span class="keyword">nullptr</span>) {  <span class="comment">// if terminal branch :</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        SplitNeuriteElement(0.1);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mother_[kIdx].IsNeuronSoma()) {  <span class="comment">// if initial branch :</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        SplitNeuriteElement(0.9);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        SplitNeuriteElement(0.5);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (actual_length_[kIdx] &lt; param-&gt;neurite_min_length_ &amp;&amp;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;               mother_[kIdx].IsNeuriteElement() &amp;&amp;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;               mother_[kIdx].GetRestingLength() &lt;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                   param-&gt;neurite_max_length_ - resting_length_[kIdx] - 1 &amp;&amp;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;               mother_[kIdx].GetDaughterRight() == <span class="keyword">nullptr</span> &amp;&amp;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;               daughter_left_[kIdx] != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <span class="comment">// if the previous branch is removed, we first remove its associated</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      <span class="comment">// NeuriteElement</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      mother_[kIdx].RemoveFromSimulation();</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      <span class="comment">// then we remove it</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      RemoveProximalNeuriteElement();</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="comment">// TODO(neurites) LB: what about ourselves??</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    }</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  }</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="comment">//   ELONGATION, RETRACTION, BRANCHING</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div>
<div class="line"><a name="l00844"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a84da3c6a74827b6ae6f622716c6bd328">  844</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a84da3c6a74827b6ae6f622716c6bd328">MovePointMass</a>(<span class="keywordtype">double</span> speed, <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; direction) {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="comment">// check if is a terminal branch</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">if</span> (daughter_left_[kIdx] != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="comment">// scaling for integration step</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keyword">auto</span>* param = Simulation_t::GetActive()-&gt;GetParam();</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordtype">double</span> length = speed * param-&gt;simulation_time_step_;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keyword">auto</span> displacement = <a class="code" href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">Math::ScalarMult</a>(length, <a class="code" href="structbdm_1_1Math.html#a06cf62fd723d1775714117f3d42cc0d4">Math::Normalize</a>(direction));</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keyword">auto</span> new_mass_location = <a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(displacement, mass_location_[kIdx]);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="comment">// here I have to define the actual length ..........</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="comment">// auto&amp; relative_pos = mother_[kIdx].GetPosition();</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keyword">auto</span> relative_ml =</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        mother_[kIdx].OriginOf(Base::GetElementIdx());  <span class="comment">//  change to auto&amp;&amp;</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    spring_axis_[kIdx] = <a class="code" href="structbdm_1_1Math.html#a80c38cbb986a66639c5ff0ccfce5674e">Math::Subtract</a>(new_mass_location, relative_ml);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    mass_location_[kIdx] = new_mass_location;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    actual_length_[kIdx] =</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        std::sqrt(<a class="code" href="structbdm_1_1Math.html#af3e942d1d0f43968c73c7b8cbba2725d">Math::Dot</a>(spring_axis_[kIdx], spring_axis_[kIdx]));</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="comment">// process of elongation : setting tension to 0 increases the resting length</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    SetRestingLengthForDesiredTension(0.0);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="comment">// some physics and computation obligations....</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    UpdateVolume();  <span class="comment">// and update concentration of internal stuff.</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    UpdateLocalCoordinateAxis();</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  }</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div>
<div class="line"><a name="l00871"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a90d2a0570b35b1bfeae2f282b4d826b9">  871</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a90d2a0570b35b1bfeae2f282b4d826b9">SetRestingLengthForDesiredTension</a>(<span class="keywordtype">double</span> tension) {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    tension_[kIdx] = tension;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordflow">if</span> (tension == 0.0) {</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      resting_length_[kIdx] = actual_length_[kIdx];</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      <span class="comment">// T = k*(A-R)/R --&gt; R = k*A/(T+K)</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      resting_length_[kIdx] = spring_constant_[kIdx] * actual_length_[kIdx] /</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                              (tension_[kIdx] + spring_constant_[kIdx]);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    }</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div>
<div class="line"><a name="l00884"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a94a70bc13d401f56b2b06bcef46eb123">  884</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a94a70bc13d401f56b2b06bcef46eb123">ChangeVolume</a>(<span class="keywordtype">double</span> speed) {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="comment">// scaling for integration step</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keyword">auto</span>* param = Simulation_t::GetActive()-&gt;GetParam();</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordtype">double</span> delta = speed * param-&gt;simulation_time_step_;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    volume_[kIdx] += delta;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">if</span> (volume_[kIdx] &lt;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        5.2359877E-7) {  <span class="comment">// minimum volume_, corresponds to minimal diameter_</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      volume_[kIdx] = 5.2359877E-7;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    }</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    UpdateDiameter();</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  }</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div>
<div class="line"><a name="l00899"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa0c38cd27aaed367ae2c4f75932702c3">  899</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa0c38cd27aaed367ae2c4f75932702c3">ChangeDiameter</a>(<span class="keywordtype">double</span> speed) {</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="comment">// scaling for integration step</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keyword">auto</span>* param = Simulation_t::GetActive()-&gt;GetParam();</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="keywordtype">double</span> delta = speed * param-&gt;simulation_time_step_;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    diameter_[kIdx] += delta;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    UpdateVolume();</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  }</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="comment">//   Physics</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="comment">// TODO(neurites) documentation</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TGr<span class="keywordtype">id</span>&gt;</div>
<div class="line"><a name="l00913"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a62706f0957d9ba31171cdd35f19e3ae7">  913</a></span>&#160;  std::array&lt;double, 3&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a62706f0957d9ba31171cdd35f19e3ae7">CalculateDisplacement</a>(TGrid * grid,</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                                              <span class="keywordtype">double</span> squared_radius) {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="comment">// decide first if we have to split or fuse this cylinder. Usually only</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="comment">// terminal branches (growth cone) do</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="keywordflow">if</span> (daughter_left_[kIdx] == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      RunDiscretization();</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    std::array&lt;double, 3&gt; force_on_my_point_mass{0, 0, 0};</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    std::array&lt;double, 3&gt; force_on_my_mothers_point_mass{0, 0, 0};</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="comment">// 1) Spring force</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="comment">//   Only the spring of this cylinder. The daughters spring also act on this</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="comment">//    mass, but they are treated in point (2)</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordtype">double</span> factor =</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        -tension_[kIdx] / actual_length_[kIdx];  <span class="comment">// the minus sign is important</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                                                 <span class="comment">// because the spring axis goes</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                                                 <span class="comment">// in the opposite direction</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    force_on_my_point_mass = <a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        force_on_my_point_mass, <a class="code" href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">Math::ScalarMult</a>(factor, spring_axis_[kIdx]));</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="comment">// 2) Force transmitted by daugthers (if they exist)</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordflow">if</span> (daughter_left_[kIdx] != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      <span class="keyword">auto</span> force_from_daughter =</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;          daughter_left_[kIdx]-&gt;ForceTransmittedFromDaugtherToMother(</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;              GetSoPtr());</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      force_on_my_point_mass =</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;          <a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(force_on_my_point_mass, force_from_daughter);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="keywordflow">if</span> (daughter_right_[kIdx] != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      <span class="keyword">auto</span> force_from_daughter =</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;          daughter_right_[kIdx]-&gt;ForceTransmittedFromDaugtherToMother(</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;              GetSoPtr());</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      force_on_my_point_mass =</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;          <a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(force_on_my_point_mass, force_from_daughter);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    }</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="comment">// 3) Object avoidance force</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="comment">//  (We check for every neighbor object if they touch us, i.e. push us away)</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keyword">auto</span> calculate_neighbor_forces = [<span class="keyword">this</span>, &amp;force_on_my_point_mass,</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                                      &amp;force_on_my_mothers_point_mass](</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <span class="keyword">auto</span>&amp;&amp; neighbor, <a class="code" href="classbdm_1_1SoHandle.html">SoHandle</a> neighbor_handle) {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      <span class="comment">// TODO(lukas) once we switch to C++17 use if constexpr.</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <span class="comment">// As a consequence the reinterpret_cast won&#39;t be needed anymore.</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <span class="comment">// if neighbor is a NeuriteElement</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      <span class="keywordflow">if</span> (neighbor.template IsSoType&lt;MostDerivedScalar&gt;()) {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <span class="keyword">auto</span>&amp;&amp; neighbor_rc =</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            neighbor.template ReinterpretCast&lt;MostDerivedScalar&gt;();</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        <span class="keyword">auto</span> n_soptr = neighbor_rc.GetSoPtr();</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="comment">// if it is a direct relative, or sister branch, we don&#39;t take it into</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <span class="comment">// account</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        <span class="keywordflow">if</span> (n_soptr == this-&gt;GetDaughterLeft() ||</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            n_soptr == this-&gt;GetDaughterRight() ||</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            (this-&gt;GetMother().IsNeuriteElement() &amp;&amp;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;             this-&gt;GetMother().GetNeuriteElementSoPtr() == n_soptr) ||</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            n_soptr-&gt;GetMother() == this-&gt;GetMother()) {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        }</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (neighbor.template IsSoType&lt;NeuronSoma&gt;()) {</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="comment">// if neighbor is NeuronSoma</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="comment">// if it is a direct relative, we don&#39;t take it into account</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="keyword">auto</span>&amp;&amp; neighbor_rc = neighbor.template ReinterpretCast&lt;NeuronSoma&gt;();</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="keyword">auto</span> n_soptr = neighbor_rc.GetSoPtr();</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="keywordflow">if</span> (this-&gt;GetMother().IsNeuronSoma() &amp;&amp;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            this-&gt;GetMother().GetNeuronSomaSoPtr() == n_soptr) {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      }</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <a class="code" href="classbdm_1_1DefaultForce.html">DefaultForce</a> force;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      std::array&lt;double, 4&gt; force_from_neighbor =</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;          force.<a class="code" href="classbdm_1_1DefaultForce.html#a9bb58e49a1f7c999c3d022659a71958a">GetForce</a>(<span class="keyword">this</span>, &amp;neighbor);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      <span class="keywordflow">if</span> (std::abs(force_from_neighbor[3]) &lt;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;          1E-10) {  <span class="comment">// TODO(neurites) hard coded value</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <span class="comment">// (if all the force is transmitted to the (distal end) point mass)</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        force_on_my_point_mass[0] += force_from_neighbor[0];</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        force_on_my_point_mass[1] += force_from_neighbor[1];</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        force_on_my_point_mass[2] += force_from_neighbor[2];</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="comment">// (if there is a part transmitted to the proximal end)</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <span class="keywordtype">double</span> part_for_point_mass = 1.0 - force_from_neighbor[3];</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        force_on_my_point_mass[0] +=</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            force_from_neighbor[0] * part_for_point_mass;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        force_on_my_point_mass[1] +=</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            force_from_neighbor[1] * part_for_point_mass;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        force_on_my_point_mass[2] +=</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            force_from_neighbor[2] * part_for_point_mass;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        force_on_my_mothers_point_mass[0] +=</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            force_from_neighbor[0] * force_from_neighbor[3];</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        force_on_my_mothers_point_mass[1] +=</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            force_from_neighbor[1] * force_from_neighbor[3];</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        force_on_my_mothers_point_mass[2] +=</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;            force_from_neighbor[2] * force_from_neighbor[3];</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      }</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    };</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    grid-&gt;ForEachNeighborWithinRadius(calculate_neighbor_forces, *<span class="keyword">this</span>,</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                                      GetSoHandle(), squared_radius);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="keywordtype">bool</span> anti_kink = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="comment">// TEST : anti-kink</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="keywordflow">if</span> (anti_kink) {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="keywordtype">double</span> kk = 5;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <span class="keywordflow">if</span> (daughter_left_[kIdx] != <span class="keyword">nullptr</span> &amp;&amp; daughter_right_[kIdx] == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="keywordflow">if</span> (daughter_left_[kIdx]-&gt;GetDaughterLeft() != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;          <span class="keyword">auto</span> downstream = daughter_left_[kIdx]-&gt;GetDaughterLeft();</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;          <span class="keywordtype">double</span> rresting = daughter_left_[kIdx]-&gt;GetRestingLength() +</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                            downstream-&gt;GetRestingLength();</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;          <span class="keyword">auto</span> down_to_me =</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;              <a class="code" href="structbdm_1_1Math.html#a80c38cbb986a66639c5ff0ccfce5674e">Math::Subtract</a>(GetMassLocation(), downstream-&gt;GetMassLocation());</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;          <span class="keywordtype">double</span> aactual = <a class="code" href="structbdm_1_1Math.html#a7f1e8761aa38ac6cb93d35bfa1ad2d26">Math::Norm</a>(down_to_me);</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;          force_on_my_point_mass =</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;              <a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(force_on_my_point_mass,</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                        <a class="code" href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">Math::ScalarMult</a>(kk * (rresting - aactual),</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                                         <a class="code" href="structbdm_1_1Math.html#a06cf62fd723d1775714117f3d42cc0d4">Math::Normalize</a>(down_to_me)));</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        }</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      }</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      <span class="keywordflow">if</span> (daughter_left_[kIdx] != <span class="keyword">nullptr</span> &amp;&amp; mother_[kIdx].IsNeuriteElement()) {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        <span class="keyword">auto</span> mother = mother_[kIdx].GetNeuriteElementSoPtr();</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        <span class="keywordtype">double</span> rresting = GetRestingLength() + mother-&gt;GetRestingLength();</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <span class="keyword">auto</span> down_to_me =</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            <a class="code" href="structbdm_1_1Math.html#a80c38cbb986a66639c5ff0ccfce5674e">Math::Subtract</a>(GetMassLocation(), mother-&gt;ProximalEnd());</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        <span class="keywordtype">double</span> aactual = <a class="code" href="structbdm_1_1Math.html#a7f1e8761aa38ac6cb93d35bfa1ad2d26">Math::Norm</a>(down_to_me);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        force_on_my_point_mass =</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            <a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(force_on_my_point_mass,</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                      <a class="code" href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">Math::ScalarMult</a>(kk * (rresting - aactual),</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                                       <a class="code" href="structbdm_1_1Math.html#a06cf62fd723d1775714117f3d42cc0d4">Math::Normalize</a>(down_to_me)));</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      }</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    }</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="comment">// 5) define the force that will be transmitted to the mother</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    force_to_transmit_to_proximal_mass_[kIdx] = force_on_my_mothers_point_mass;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="comment">//  6.1) Define movement scale</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="keywordtype">double</span> h_over_m = 1.0;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="keywordtype">double</span> force_norm = <a class="code" href="structbdm_1_1Math.html#a7f1e8761aa38ac6cb93d35bfa1ad2d26">Math::Norm</a>(force_on_my_point_mass);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="comment">//  6.2) If is F not strong enough -&gt; no movements</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="keywordflow">if</span> (force_norm &lt; adherence_[kIdx]) {</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <span class="keywordflow">return</span> {0, 0, 0};</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="comment">// if this or its mother is a branching point, displacement have to be</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="comment">// reduced to avoid kink behaviour</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keyword">auto</span>* param = Simulation_t::GetActive()-&gt;GetParam();</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keywordflow">if</span> (mother_[kIdx].IsNeuriteElement()) {</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      <span class="keyword">auto</span> mother = mother_[kIdx].GetNeuriteElementSoPtr();</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      <span class="keywordflow">if</span> (mother-&gt;GetDaughterLeft() != <span class="keyword">nullptr</span> &amp;&amp;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;          mother-&gt;GetDaughterRight() != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        <span class="keywordtype">double</span> h = param-&gt;simulation_time_step_;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        h_over_m = h / GetMass();</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    }</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordflow">if</span> (daughter_left_[kIdx] != <span class="keyword">nullptr</span> &amp;&amp; daughter_right_[kIdx] != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <span class="keywordtype">double</span> h = param-&gt;simulation_time_step_;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      h_over_m = h / GetMass();</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    }</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="comment">// So, what follows is only executed if we do actually move :</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="comment">//  6.3) Since there&#39;s going be a move, we calculate it</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="keyword">auto</span> displacement = <a class="code" href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">Math::ScalarMult</a>(h_over_m, force_on_my_point_mass);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keywordtype">double</span> displacement_norm = force_norm * h_over_m;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="comment">//  6.4) There is an upper bound for the movement.</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordflow">if</span> (displacement_norm &gt; param-&gt;simulation_max_displacement_) {</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      displacement = <a class="code" href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">Math::ScalarMult</a>(</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;          param-&gt;simulation_max_displacement_ / displacement_norm,</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;          displacement);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    }</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="keywordflow">return</span> displacement;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  }</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="comment">// TODO(neurites) documentation</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a6d1cbfd883b7127ecc71639c9a131470"> 1089</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a6d1cbfd883b7127ecc71639c9a131470">ApplyDisplacement</a>(<span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; displacement) {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="comment">// move of our mass</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    SetMassLocation(<a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(GetMassLocation(), displacement));</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="comment">// Recompute length, tension and re-center the computation node, and</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="comment">// redefine axis</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    UpdateDependentPhysicalVariables();</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    UpdateLocalCoordinateAxis();</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="comment">// FIXME this whole block might be superfluous - ApplyDisplacement is called</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="comment">// For the relatives: recompute the lenght, tension etc. (why for mother?</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="comment">// have to think about that)</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">if</span> (daughter_left_[kIdx] != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      <span class="comment">// FIXME this is problematic for the distributed version. it modifies a</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      <span class="comment">// &quot;neightbor&quot;</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      daughter_left_[kIdx]-&gt;UpdateDependentPhysicalVariables();</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      daughter_left_[kIdx]-&gt;UpdateLocalCoordinateAxis();</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    }</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">if</span> (daughter_right_[kIdx] != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      <span class="comment">// FIXME this is problematic for the distributed version. it modifies a</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      <span class="comment">// &quot;neightbor&quot;</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      daughter_right_[kIdx]-&gt;UpdateDependentPhysicalVariables();</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      daughter_right_[kIdx]-&gt;UpdateLocalCoordinateAxis();</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    }</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  }</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;</div>
<div class="line"><a name="l01119"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a05e4d24ea9ecedee749cacce199a4af9"> 1119</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a05e4d24ea9ecedee749cacce199a4af9">UpdateLocalCoordinateAxis</a>() {</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="comment">// x (new) = something new</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="comment">// z (new) = x (new) cross y(old)</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="comment">// y (new) = z(new) cross x(new)</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    x_axis_[kIdx] = <a class="code" href="structbdm_1_1Math.html#a06cf62fd723d1775714117f3d42cc0d4">Math::Normalize</a>(spring_axis_[kIdx]);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    z_axis_[kIdx] = <a class="code" href="structbdm_1_1Math.html#abfb252b62698eaa4176ec9a83e89bf37">Math::CrossProduct</a>(x_axis_[kIdx], y_axis_[kIdx]);</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keywordtype">double</span> norm_of_z = <a class="code" href="structbdm_1_1Math.html#a7f1e8761aa38ac6cb93d35bfa1ad2d26">Math::Norm</a>(z_axis_[kIdx]);</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="keywordflow">if</span> (norm_of_z &lt; 1E-10) {  <span class="comment">// TODO(neurites) use parameter</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      <span class="comment">// If new x_axis_ and old y_axis_ are aligned, we cannot use this scheme;</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      <span class="comment">// we start by re-defining new perp vectors. Ok, we loose the previous</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <span class="comment">// info, but this should almost never happen....</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      <span class="keyword">auto</span>* random = Simulation_t::GetActive()-&gt;GetRandom();</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      z_axis_[kIdx] = <a class="code" href="structbdm_1_1Math.html#a0295284d54dc8b78b7d981fefe373889">Math::Perp3</a>(x_axis_[kIdx], random-&gt;Uniform(0, 1));</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      z_axis_[kIdx] = <a class="code" href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">Math::ScalarMult</a>((1 / norm_of_z), z_axis_[kIdx]);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    }</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    y_axis_[kIdx] = <a class="code" href="structbdm_1_1Math.html#abfb252b62698eaa4176ec9a83e89bf37">Math::CrossProduct</a>(z_axis_[kIdx], x_axis_[kIdx]);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  }</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;</div>
<div class="line"><a name="l01139"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a3ce0aa920133b0abf451c45b70187973"> 1139</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a3ce0aa920133b0abf451c45b70187973">UpdateDiameter</a>() {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    diameter_[kIdx] =</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        std::sqrt(4 / <a class="code" href="structbdm_1_1Math.html#a59ce6781aaf6ed4ee0c7648fd33f6b55">Math::kPi</a> * volume_[kIdx] / actual_length_[kIdx]);</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  }</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div>
<div class="line"><a name="l01145"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ada9bfaab59827023fb40e58e468e95ca"> 1145</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ada9bfaab59827023fb40e58e468e95ca">UpdateVolume</a>() {</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    volume_[kIdx] = <a class="code" href="structbdm_1_1Math.html#a59ce6781aaf6ed4ee0c7648fd33f6b55">Math::kPi</a> / 4 * diameter_[kIdx] * diameter_[kIdx] *</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                    actual_length_[kIdx];</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  }</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <span class="comment">//   Coordinates transform</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;</div>
<div class="line"><a name="l01184"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a2820beb162a49235208a018bbf49b521"> 1184</a></span>&#160;  std::array&lt;double, 3&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a2820beb162a49235208a018bbf49b521">TransformCoordinatesGlobalToLocal</a>(</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; position)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keyword">auto</span> pos = <a class="code" href="structbdm_1_1Math.html#a80c38cbb986a66639c5ff0ccfce5674e">Math::Subtract</a>(position, ProximalEnd());</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="keywordflow">return</span> {<a class="code" href="structbdm_1_1Math.html#af3e942d1d0f43968c73c7b8cbba2725d">Math::Dot</a>(pos, x_axis_[kIdx]), <a class="code" href="structbdm_1_1Math.html#af3e942d1d0f43968c73c7b8cbba2725d">Math::Dot</a>(pos, y_axis_[kIdx]),</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            <a class="code" href="structbdm_1_1Math.html#af3e942d1d0f43968c73c7b8cbba2725d">Math::Dot</a>(pos, z_axis_[kIdx])};</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  }</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;</div>
<div class="line"><a name="l01196"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a1ba633c65008a89b5297e1620dfe6986"> 1196</a></span>&#160;  std::array&lt;double, 3&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a1ba633c65008a89b5297e1620dfe6986">TransformCoordinatesLocalToGlobal</a>(</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; position)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    std::array&lt;double, 3&gt; glob{</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        position[0] * x_axis_[kIdx][0] + position[1] * y_axis_[kIdx][0] +</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;            position[2] * z_axis_[kIdx][0],</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        position[0] * x_axis_[kIdx][1] + position[1] * y_axis_[kIdx][1] +</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            position[2] * z_axis_[kIdx][1],</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        position[0] * x_axis_[kIdx][2] + position[1] * y_axis_[kIdx][2] +</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;            position[2] * z_axis_[kIdx][2]};</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(glob, ProximalEnd());</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  }</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div>
<div class="line"><a name="l01212"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a4450d80772509a36ba58bfb857946fd6"> 1212</a></span>&#160;  std::array&lt;double, 3&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a4450d80772509a36ba58bfb857946fd6">TransformCoordinatesLocalToPolar</a>(</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; position)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keywordflow">return</span> {position[0], std::atan2(position[2], position[1]),</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;            std::sqrt(position[1] * position[1] + position[2] * position[2])};</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;</div>
<div class="line"><a name="l01222"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#adc2ea69342c768dc688c7a5ea376567a"> 1222</a></span>&#160;  std::array&lt;double, 3&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#adc2ea69342c768dc688c7a5ea376567a">TransformCoordinatesPolarToLocal</a>(</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; position)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">return</span> {position[0], position[2] * std::cos(position[1]),</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;            position[2] * std::sin(position[1])};</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  }</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;</div>
<div class="line"><a name="l01229"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a57b1698159831da2e38971d6711d27d0"> 1229</a></span>&#160;  std::array&lt;double, 3&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a57b1698159831da2e38971d6711d27d0">TransformCoordinatesPolarToGlobal</a>(</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <span class="keyword">const</span> std::array&lt;double, 2&gt;&amp; position)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="comment">// the position is in cylindrical coord (h,theta,r)</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="comment">// with r being implicit (half the diameter_)</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="comment">// We thus have h (along x_axis_) and theta (the angle from the y_axis_).</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordtype">double</span> r = 0.5 * diameter_;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    std::array&lt;double, 3&gt; polar_position{position[0], position[1], r};</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keyword">auto</span> local = TransformCoordinatesPolarToLocal(polar_position);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">return</span> TransformCoordinatesLocalToGlobal(local);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  }</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div>
<div class="line"><a name="l01241"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a061c427d08f461415aab8df011153ee7"> 1241</a></span>&#160;  std::array&lt;double, 3&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a061c427d08f461415aab8df011153ee7">TransformCoordinatesGlobalToPolar</a>(</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;      <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; position)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keyword">auto</span> local = TransformCoordinatesGlobalToLocal(position);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keywordflow">return</span> TransformCoordinatesLocalToPolar(local);</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  }</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  <span class="comment">//   GETTERS &amp; SETTERS</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;</div>
<div class="line"><a name="l01251"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a44712e47cd760e0bbc736979aa64d110"> 1251</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a44712e47cd760e0bbc736979aa64d110">IsAxon</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> is_axon_[kIdx]; }</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div>
<div class="line"><a name="l01253"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aba6e4cddfe735f9ac2482806678adff2"> 1253</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aba6e4cddfe735f9ac2482806678adff2">SetAxon</a>(<span class="keywordtype">bool</span> is_axon) { is_axon_[kIdx] = is_axon; }</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  <span class="comment">// FIXME</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <span class="comment">// const NeuriteOrNeuron&amp; GetMother() const;</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a4a30f0cc6bf73ea6f43ec4566e8f6108"> 1257</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">NeuriteOrNeuron</a> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a4a30f0cc6bf73ea6f43ec4566e8f6108">GetMother</a>() { <span class="keywordflow">return</span> mother_[kIdx]; }</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div>
<div class="line"><a name="l01259"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a93cec9baba560ad9c4404e6f65b59a82"> 1259</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a93cec9baba560ad9c4404e6f65b59a82">SetMother</a>(<span class="keyword">const</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">NeuriteOrNeuron</a>&amp; mother) { mother_[kIdx] = mother; }</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div>
<div class="line"><a name="l01263"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a49b5c5aae648531e663283e552109830"> 1263</a></span>&#160;  <span class="keyword">const</span> MostDerivedSoPtr&amp; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a49b5c5aae648531e663283e552109830">GetDaughterLeft</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="keywordflow">return</span> daughter_left_[kIdx];</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  }</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;</div>
<div class="line"><a name="l01267"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a6eb70a443297042b8e4435479a496b4e"> 1267</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a6eb70a443297042b8e4435479a496b4e">SetDaughterLeft</a>(<span class="keyword">const</span> MostDerivedSoPtr&amp; daughter) {</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    daughter_left_[kIdx] = daughter;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  }</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;</div>
<div class="line"><a name="l01274"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a8af344ef91ad0bb20ccdb52ccfaf3c43"> 1274</a></span>&#160;  <span class="keyword">const</span> MostDerivedSoPtr&amp; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a8af344ef91ad0bb20ccdb52ccfaf3c43">GetDaughterRight</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keywordflow">return</span> daughter_right_[kIdx];</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  }</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;</div>
<div class="line"><a name="l01278"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a2be8674a74cdafb7f0c1cfd598687a0e"> 1278</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a2be8674a74cdafb7f0c1cfd598687a0e">SetDaughterRight</a>(<span class="keyword">const</span> MostDerivedSoPtr&amp; daughter) {</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    daughter_right_[kIdx] = daughter;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  }</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div>
<div class="line"><a name="l01282"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ae41e75fb8eda7a3ab3d0dd6f02421c40"> 1282</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ae41e75fb8eda7a3ab3d0dd6f02421c40">GetBranchOrder</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> branch_order_[kIdx]; }</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;</div>
<div class="line"><a name="l01284"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a68e12f41972d921dc7ee44ffd3bd40e8"> 1284</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a68e12f41972d921dc7ee44ffd3bd40e8">SetBranchOrder</a>(<span class="keywordtype">int</span> branch_order) { branch_order_[kIdx] = branch_order; }</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;</div>
<div class="line"><a name="l01286"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a350477fabd5c335635541063828e65fd"> 1286</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a350477fabd5c335635541063828e65fd">GetActualLength</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> actual_length_[kIdx]; }</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div>
<div class="line"><a name="l01289"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#adfd6c42e932ef402bedf9b7952375d6c"> 1289</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#adfd6c42e932ef402bedf9b7952375d6c">SetActualLength</a>(<span class="keywordtype">double</span> actual_length) {</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    actual_length_[kIdx] = actual_length;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  }</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div>
<div class="line"><a name="l01293"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a1416baf8adfb5e1fd4e1bb7ea0e1a1f0"> 1293</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a1416baf8adfb5e1fd4e1bb7ea0e1a1f0">GetRestingLength</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> resting_length_[kIdx]; }</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;</div>
<div class="line"><a name="l01295"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a4ecdf160a7621f5a0d667734ffd7b247"> 1295</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a4ecdf160a7621f5a0d667734ffd7b247">SetRestingLength</a>(<span class="keywordtype">double</span> resting_length) {</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    resting_length_[kIdx] = resting_length;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  }</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div>
<div class="line"><a name="l01299"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ad8c7f4af2ee3ffc1d11d365618975fc0"> 1299</a></span>&#160;  <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ad8c7f4af2ee3ffc1d11d365618975fc0">GetSpringAxis</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="keywordflow">return</span> spring_axis_[kIdx];</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  }</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div>
<div class="line"><a name="l01303"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa0afb8714114c79f6f75b9f6da486f05"> 1303</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa0afb8714114c79f6f75b9f6da486f05">SetSpringAxis</a>(<span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; axis) {</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    spring_axis_[kIdx] = axis;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  }</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;</div>
<div class="line"><a name="l01307"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ad71da6765196de401d1546833939c28d"> 1307</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ad71da6765196de401d1546833939c28d">GetSpringConstant</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> spring_constant_[kIdx]; }</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;</div>
<div class="line"><a name="l01309"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa74bdf2edb57bbcc68dc1450d6625bd2"> 1309</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa74bdf2edb57bbcc68dc1450d6625bd2">SetSpringConstant</a>(<span class="keywordtype">double</span> spring_constant) {</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    spring_constant_[kIdx] = spring_constant;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  }</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;</div>
<div class="line"><a name="l01313"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a94834ee0cb2248fe8da785c991564b55"> 1313</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a94834ee0cb2248fe8da785c991564b55">GetTension</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> tension_[kIdx]; }</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div>
<div class="line"><a name="l01315"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ab95ca95765e53c030e9b147ec34eab41"> 1315</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ab95ca95765e53c030e9b147ec34eab41">SetTension</a>(<span class="keywordtype">double</span> tension) { tension_[kIdx] = tension; }</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div>
<div class="line"><a name="l01320"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a7081cfee876b7518053dd39948ce1298"> 1320</a></span>&#160;  std::array&lt;double, 3&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a7081cfee876b7518053dd39948ce1298">GetUnitaryAxisDirectionVector</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="keywordtype">double</span> factor = 1.0 / actual_length_[kIdx];</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">Math::ScalarMult</a>(factor, spring_axis_[kIdx]);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  }</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div>
<div class="line"><a name="l01327"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ac35dc2737816d652cf8f6c15b482b293"> 1327</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ac35dc2737816d652cf8f6c15b482b293">IsTerminal</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> daughter_left_[kIdx] == <span class="keyword">nullptr</span>; }</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div>
<div class="line"><a name="l01332"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#af5cd210958e13be0e40d99abd5aa3b02"> 1332</a></span>&#160;  std::array&lt;double, 3&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#af5cd210958e13be0e40d99abd5aa3b02">ProximalEnd</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structbdm_1_1Math.html#a80c38cbb986a66639c5ff0ccfce5674e">Math::Subtract</a>(mass_location_[kIdx], spring_axis_[kIdx]);</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  }</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;</div>
<div class="line"><a name="l01337"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a1ea404d14ba536d2fe7cb1f4c725531e"> 1337</a></span>&#160;  <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a1ea404d14ba536d2fe7cb1f4c725531e">DistalEnd</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="keywordflow">return</span> mass_location_[kIdx];</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  }</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div>
<div class="line"><a name="l01346"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a1f19da92d69d9dea141df43c925a9066"> 1346</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a1f19da92d69d9dea141df43c925a9066">LengthToProximalBranchingPoint</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="keywordtype">double</span> length = actual_length_;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <span class="keywordflow">if</span> (mother_-&gt;IsNeuriteElement()) {</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;      <span class="keywordflow">if</span> (mother_-&gt;GetDaughterRight() == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        length += mother_-&gt;LengthToProximalBranchingPoint();</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;      }</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    }</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="keywordflow">return</span> length;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  }</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;</div>
<div class="line"><a name="l01356"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a5d1ca6b3880840e9b7f0aa36fc4374ee"> 1356</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a5d1ca6b3880840e9b7f0aa36fc4374ee">GetLength</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> actual_length_[kIdx]; }</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;</div>
<div class="line"><a name="l01359"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a04560b9cb9811940e8c0ab1e116a5ac7"> 1359</a></span>&#160;  <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a04560b9cb9811940e8c0ab1e116a5ac7">GetAxis</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <span class="comment">// local coordinate x_axis_ is equal to cylinder axis</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <span class="keywordflow">return</span> x_axis_[kIdx];</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  }</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div>
<div class="line"><a name="l01369"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a8acc432d3f78b8bdf0bbf5129380de4a"> 1369</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a8acc432d3f78b8bdf0bbf5129380de4a">UpdateDependentPhysicalVariables</a>() {</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="keyword">auto</span> relative_ml = mother_[kIdx].OriginOf(Base::GetElementIdx());</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    spring_axis_[kIdx] = <a class="code" href="structbdm_1_1Math.html#a80c38cbb986a66639c5ff0ccfce5674e">Math::Subtract</a>(mass_location_[kIdx], relative_ml);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    actual_length_[kIdx] =</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        std::sqrt(<a class="code" href="structbdm_1_1Math.html#af3e942d1d0f43968c73c7b8cbba2725d">Math::Dot</a>(spring_axis_[kIdx], spring_axis_[kIdx]));</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <span class="keywordflow">if</span> (std::abs(actual_length_[kIdx] - resting_length_[kIdx]) &gt; 1e-13) {</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      tension_[kIdx] = spring_constant_[kIdx] *</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                       (actual_length_[kIdx] - resting_length_[kIdx]) /</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                       resting_length_[kIdx];</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      <span class="comment">// avoid floating point rounding effects that increase the tension</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      tension_[kIdx] = 0.0;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    }</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    UpdateVolume();</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  }</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;</div>
<div class="line"><a name="l01385"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#acec4bd49b57adfc7a9256a38d10beb25"> 1385</a></span>&#160;  <span class="keyword">friend</span> std::ostream&amp; operator&lt;&lt;(std::ostream&amp; str, const Self&lt;Backend&gt;&amp; n) {</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keyword">auto</span> pos = n.GetPosition();</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    str &lt;&lt; <span class="stringliteral">&quot;MassLocation:     &quot;</span> &lt;&lt; n.mass_location_[n.kIdx][0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        &lt;&lt; n.mass_location_[n.kIdx][1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; n.mass_location_[n.kIdx][2]</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    str &lt;&lt; <span class="stringliteral">&quot;Position:         &quot;</span> &lt;&lt; pos[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; pos[1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; pos[2]</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    str &lt;&lt; <span class="stringliteral">&quot;x_axis_:          &quot;</span> &lt;&lt; n.x_axis_[n.kIdx][0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        &lt;&lt; n.x_axis_[n.kIdx][1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; n.x_axis_[n.kIdx][2] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        &lt;&lt; std::endl;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    str &lt;&lt; <span class="stringliteral">&quot;y_axis_:          &quot;</span> &lt;&lt; n.y_axis_[n.kIdx][0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        &lt;&lt; n.y_axis_[n.kIdx][1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; n.y_axis_[n.kIdx][2] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        &lt;&lt; std::endl;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    str &lt;&lt; <span class="stringliteral">&quot;z_axis_:          &quot;</span> &lt;&lt; n.z_axis_[n.kIdx][0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        &lt;&lt; n.z_axis_[n.kIdx][1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; n.z_axis_[n.kIdx][2] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;        &lt;&lt; std::endl;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    str &lt;&lt; <span class="stringliteral">&quot;spring_axis_:     &quot;</span> &lt;&lt; n.spring_axis_[n.kIdx][0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;        &lt;&lt; n.spring_axis_[n.kIdx][1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; n.spring_axis_[n.kIdx][2]</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    str &lt;&lt; <span class="stringliteral">&quot;volume_:          &quot;</span> &lt;&lt; n.volume_[n.kIdx] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    str &lt;&lt; <span class="stringliteral">&quot;diameter_:        &quot;</span> &lt;&lt; n.diameter_[n.kIdx] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    str &lt;&lt; <span class="stringliteral">&quot;is_axon_:  &quot;</span> &lt;&lt; n.is_axon_[n.kIdx] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    str &lt;&lt; <span class="stringliteral">&quot;branch_order_:    &quot;</span> &lt;&lt; n.branch_order_[n.kIdx] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    str &lt;&lt; <span class="stringliteral">&quot;actual_length_:   &quot;</span> &lt;&lt; n.actual_length_[n.kIdx] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    str &lt;&lt; <span class="stringliteral">&quot;tension_:  &quot;</span> &lt;&lt; n.tension_[n.kIdx] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    str &lt;&lt; <span class="stringliteral">&quot;spring_constant_: &quot;</span> &lt;&lt; n.spring_constant_[n.kIdx] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    str &lt;&lt; <span class="stringliteral">&quot;resting_length_:  &quot;</span> &lt;&lt; n.resting_length_[n.kIdx] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keyword">auto</span> mother =</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        n.mother_[n.kIdx].IsNeuronSoma()</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;            ? <span class="stringliteral">&quot;neuron&quot;</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;            : (n.mother_[n.kIdx].IsNeuriteElement() ? <span class="stringliteral">&quot;neurite&quot;</span> : <span class="stringliteral">&quot;nullptr&quot;</span>);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    str &lt;&lt; <span class="stringliteral">&quot;mother_           &quot;</span> &lt;&lt; mother &lt;&lt; std::endl;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="keywordflow">return</span> str;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  }</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  <span class="comment">// FIXME make protected after ROOT issue has been resolved and all</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  <span class="comment">// biology_modules_ are in one class.</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a4b539af48347b27061a2b0aaee27812c"> 1423</a></span>&#160;<span class="comment"></span>  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;std::vector&lt;BiologyModules&gt;</a>&gt; <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a4b539af48347b27061a2b0aaee27812c">biology_modules_</a>;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160; <span class="keyword">protected</span>:</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TBackend&gt;</div>
<div class="line"><a name="l01427"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a2819596608096310568d593b63ff1553"> 1427</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a2819596608096310568d593b63ff1553">Copy</a>(<span class="keyword">const</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aca6c5356ac82eb01a3796f256dabfb52">MostDerived&lt;TBackend&gt;</a>&amp; rhs) {</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="comment">// TODO(neurites) adherence</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    adherence_[kIdx] = rhs.GetAdherence();</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="comment">//  density_</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    SetDiameter(rhs.GetDiameter());  <span class="comment">// also updates voluume</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    x_axis_[kIdx] = rhs.GetXAxis();</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    y_axis_[kIdx] = rhs.GetYAxis();</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    z_axis_[kIdx] = rhs.GetZAxis();</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    spring_axis_[kIdx] = rhs.GetSpringAxis();</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    branch_order_[kIdx] = rhs.GetBranchOrder();</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    spring_constant_[kIdx] = rhs.GetSpringConstant();</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="comment">// TODO(neurites) what about actual length, tension and resting_length_ ??</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  }</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TDaughter&gt;</div>
<div class="line"><a name="l01450"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a3ff53e941df9379f56fbab9cd23e469a"> 1450</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a3ff53e941df9379f56fbab9cd23e469a">EventHandler</a>(<span class="keyword">const</span> <a class="code" href="structbdm_1_1experimental_1_1neuroscience_1_1NeuriteBifurcationEvent.html">NeuriteBifurcationEvent</a>&amp; event, TDaughter* left,</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                    TDaughter* right) {</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    SetDaughterLeft(left-&gt;GetSoPtr());</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    SetDaughterRight(right-&gt;GetSoPtr());</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="comment">// call event handler for biology modules</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="keyword">auto</span>* left_bms = &amp;(left-&gt;biology_modules_[left-&gt;kIdx]);</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="keyword">auto</span>* right_bms = &amp;(right-&gt;biology_modules_[right-&gt;kIdx]);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <a class="code" href="namespacebdm.html#a3b4c908b7fd30c77a880d0c2e86c570e">BiologyModuleEventHandler</a>(event, &amp;(biology_modules_[kIdx]), left_bms,</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                              right_bms);</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  }</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TDaughter&gt;</div>
<div class="line"><a name="l01467"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa5a3ebfc78ecf0123985178bbc1c7902"> 1467</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa5a3ebfc78ecf0123985178bbc1c7902">EventHandler</a>(<span class="keyword">const</span> <a class="code" href="structbdm_1_1experimental_1_1neuroscience_1_1SideNeuriteExtensionEvent.html">SideNeuriteExtensionEvent</a>&amp; event, TDaughter* right) {</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    SetDaughterRight(right-&gt;GetSoPtr());</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="comment">// call event handler for biology modules</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keyword">auto</span>* right_bms = &amp;(right-&gt;biology_modules_[right-&gt;kIdx]);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <a class="code" href="namespacebdm.html#a3b4c908b7fd30c77a880d0c2e86c570e">BiologyModuleEventHandler</a>(event, &amp;(biology_modules_[kIdx]), right_bms);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  }</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TNeurite&gt;</div>
<div class="line"><a name="l01483"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aec081ad14324afdc58fbd1984ac42623"> 1483</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aec081ad14324afdc58fbd1984ac42623">EventHandler</a>(<span class="keyword">const</span> <a class="code" href="structbdm_1_1experimental_1_1neuroscience_1_1SplitNeuriteElementEvent.html">SplitNeuriteElementEvent</a>&amp; event, TNeurite* proximal) {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    resting_length_[kIdx] *= <span class="keyword">event</span>.distal_portion_;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <span class="comment">// family relations</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    mother_[kIdx].UpdateRelative(<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">NeuriteOrNeuron</a>(GetSoPtr()),</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                                 <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">NeuriteOrNeuron</a>(proximal-&gt;GetSoPtr()));</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    mother_[kIdx] = proximal-&gt;GetSoPtr();</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    UpdateDependentPhysicalVariables();</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    proximal-&gt;UpdateDependentPhysicalVariables();</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="comment">// UpdateLocalCoordinateAxis has to come after UpdateDepend...</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    proximal-&gt;UpdateLocalCoordinateAxis();</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="comment">// call event handler for biology modules</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="keyword">auto</span>* proximal_bms = &amp;(proximal-&gt;biology_modules_[proximal-&gt;kIdx]);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <a class="code" href="namespacebdm.html#a3b4c908b7fd30c77a880d0c2e86c570e">BiologyModuleEventHandler</a>(event, &amp;(biology_modules_[kIdx]), proximal_bms);</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  }</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TNeuriteElement&gt;</div>
<div class="line"><a name="l01509"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a45d0d4d0a5bcb6cbbbe639eb2c58e9ae"> 1509</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a45d0d4d0a5bcb6cbbbe639eb2c58e9ae">EventHandler</a>(<span class="keyword">const</span> <a class="code" href="structbdm_1_1experimental_1_1neuroscience_1_1NeuriteBranchingEvent.html">NeuriteBranchingEvent</a>&amp; event,</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                    TNeuriteElement* proximal, TNeuriteElement* branch) {</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <span class="comment">// TODO(lukas) some code duplication with SplitNeuriteElementEvent and</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="comment">// SideNeuriteExtensionEvent event handler</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    proximal-&gt;SetDaughterRight(branch-&gt;GetSoPtr());</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="comment">// elongation</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    resting_length_[kIdx] *= <span class="keyword">event</span>.distal_portion_;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    mother_[kIdx].UpdateRelative(<a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">NeuriteOrNeuron</a>(GetSoPtr()),</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                                 <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">NeuriteOrNeuron</a>(proximal-&gt;GetSoPtr()));</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    mother_[kIdx] = proximal-&gt;GetSoPtr();</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    UpdateDependentPhysicalVariables();</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    proximal-&gt;UpdateDependentPhysicalVariables();</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="comment">// UpdateLocalCoordinateAxis has to come after UpdateDepend...</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    proximal-&gt;UpdateLocalCoordinateAxis();</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="comment">// call event handler for biology modules</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    <span class="keyword">auto</span>* proximal_bms = &amp;(proximal-&gt;biology_modules_[proximal-&gt;kIdx]);</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <span class="keyword">auto</span>* branch_bms = &amp;(branch-&gt;biology_modules_[branch-&gt;kIdx]);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <a class="code" href="namespacebdm.html#a3b4c908b7fd30c77a880d0c2e86c570e">BiologyModuleEventHandler</a>(event, &amp;(biology_modules_[kIdx]), proximal_bms,</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                              branch_bms);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  }</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  <span class="comment">// TODO(lukas) data members same as in cell -&gt; resolve once ROOT-9321 has been</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  <span class="comment">// resolved</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a747d4543a737b0cea5cdc82acd7df6cf"> 1538</a></span>&#160;<span class="comment"></span>  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;std::array&lt;double, 3&gt;</a>&gt; mass_location_ = {{0.0, 0.0, 0.0}};</div>
<div class="line"><a name="l01539"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a648e6c03a28376672d32b3060d1f7387"> 1539</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;double&gt;</a> volume_ = {{}};</div>
<div class="line"><a name="l01540"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a3b4d536a8db231b5dd3c306832c14476"> 1540</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;double&gt;</a> diameter_ = {{}};</div>
<div class="line"><a name="l01541"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a361bbbcf231aa32bca7cf33575c83cb6"> 1541</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;double&gt;</a> density_ = {{}};</div>
<div class="line"><a name="l01542"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a91dbb5b1dd8e528b49335bedd9381880"> 1542</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;double&gt;</a> adherence_ = {{}};</div>
<div class="line"><a name="l01544"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a6da989481963a246b476c8171e1f83ab"> 1544</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;std::array&lt;double, 3&gt;</a>&gt; x_axis_ = {{1.0, 0.0, 0.0}};</div>
<div class="line"><a name="l01546"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a8b0dfec1fead70843ba0d80e938094ae"> 1546</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;std::array&lt;double, 3&gt;</a>&gt; y_axis_ = {{0.0, 1.0, 0.0}};</div>
<div class="line"><a name="l01548"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa8833ffd1044fd009d65d2bdb9c0c387"> 1548</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;std::array&lt;double, 3&gt;</a>&gt; z_axis_ = {{0.0, 0.0, 1.0}};</div>
<div class="line"><a name="l01550"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a76e6008ba5bc8c672341223714e6a3a3"> 1550</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;uint64_t&gt;</a> box_idx_ = {{}};</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;</div>
<div class="line"><a name="l01552"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a56f1bc04ba1d5c0ff3bf050e0450f735"> 1552</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;bool&gt;</a> is_axon_ = {{<span class="keyword">false</span>}};</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div>
<div class="line"><a name="l01556"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a1c8002c784ed040409b437239322c2f6"> 1556</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;NeuriteOrNeuron&gt;</a> mother_ = {{}};</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;</div>
<div class="line"><a name="l01560"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a1ab3494db1f59e8897355d9075b6dad5"> 1560</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;MostDerivedSoPtr&gt;</a> daughter_left_ = {{}};</div>
<div class="line"><a name="l01563"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a131d12c9692f82f5347cf1c8d8e2b6d8"> 1563</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;MostDerivedSoPtr&gt;</a> daughter_right_ = {{}};</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;</div>
<div class="line"><a name="l01567"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ab6b2d74fe538c823d24f9414357356ab"> 1567</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;int&gt;</a> branch_order_ = {0};</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;</div>
<div class="line"><a name="l01570"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a02a1ffdac15f600af1e456bddfc0c12c"> 1570</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;std::array&lt;double, 3&gt;</a>&gt; force_to_transmit_to_proximal_mass_ = {{0, 0, 0}};</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;</div>
<div class="line"><a name="l01574"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#af58a567da301c7274ec9e5f1916fbf1e"> 1574</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;std::array&lt;double, 3&gt;</a>&gt; spring_axis_ = {{0, 0, 0}};</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;</div>
<div class="line"><a name="l01577"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a2b6710318f9ef15b9ccb2ea88e9ba8bc"> 1577</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;double&gt;</a> actual_length_ = {{}};</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;</div>
<div class="line"><a name="l01580"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ac1e9756ffcba47b1007031394e7d795e"> 1580</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;double&gt;</a> tension_ = {{}};</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;</div>
<div class="line"><a name="l01584"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a1eff53e410c847278b953275e605727a"> 1584</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;double&gt;</a> spring_constant_ = {{}};</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;</div>
<div class="line"><a name="l01588"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a4815f1333fba1752ff31e8b5b5e4ac85"> 1588</a></span>&#160;  <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">vec&lt;double&gt;</a> resting_length_ = {spring_constant_[kIdx] * actual_length_[kIdx] /</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                                 (tension_[kIdx] + spring_constant_[kIdx])};</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;</div>
<div class="line"><a name="l01594"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a887391d924ff8c300c7d8938e5f0db58"> 1594</a></span>&#160;  MostDerivedSoPtr <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a887391d924ff8c300c7d8938e5f0db58">SplitNeuriteElement</a>(<span class="keywordtype">double</span> distal_portion = 0.5) {</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="keyword">auto</span>* rm = Simulation_t::GetActive()-&gt;GetResourceManager();</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    <a class="code" href="structbdm_1_1experimental_1_1neuroscience_1_1SplitNeuriteElementEvent.html">SplitNeuriteElementEvent</a> <span class="keyword">event</span> = {distal_portion};</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    <span class="keyword">auto</span>&amp;&amp; new_proximal_element =</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;        rm-&gt;template New&lt;MostDerivedScalar&gt;(event, ThisMD());</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    ThisMD()-&gt;EventHandler(event, &amp;new_proximal_element);</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="keywordflow">return</span> new_proximal_element.GetSoPtr();</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  }</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div>
<div class="line"><a name="l01605"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a78eee73a48c5bae5b0b2ee359e3bd527"> 1605</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a78eee73a48c5bae5b0b2ee359e3bd527">RemoveProximalNeuriteElement</a>() {</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    <span class="comment">// The mother is removed if (a) it is a neurite element and (b) it has no</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="comment">// other daughter than</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="keywordflow">if</span> (!mother_[kIdx].IsNeuriteElement() ||</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;        mother_[kIdx].GetDaughterRight() != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    }</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="comment">// The guy we gonna remove</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <span class="keyword">auto</span> proximal_ne = mother_[kIdx].GetNeuriteElementSoPtr();</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <span class="comment">// Re-organisation of the PhysicalObject tree structure: by-passing</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="comment">// proximalCylinder</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    proximal_ne-&gt;GetMother().UpdateRelative(mother_[kIdx],</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                                            <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">NeuriteOrNeuron</a>(GetSoPtr()));</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    SetMother(mother_[kIdx].GetMother());</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="comment">// Keeping the same tension :</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="comment">// (we don&#39;t use updateDependentPhysicalVariables(), because we have tension</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="comment">// and want to</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="comment">// compute restingLength, and not the opposite...)</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="comment">// T = k*(A-R)/R --&gt; R = k*A/(T+K)</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    spring_axis_[kIdx] = <a class="code" href="structbdm_1_1Math.html#a80c38cbb986a66639c5ff0ccfce5674e">Math::Subtract</a>(</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        mass_location_[kIdx], mother_[kIdx].OriginOf(Base::GetElementIdx()));</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    actual_length_[kIdx] = <a class="code" href="structbdm_1_1Math.html#a7f1e8761aa38ac6cb93d35bfa1ad2d26">Math::Norm</a>(spring_axis_[kIdx]);</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    resting_length_[kIdx] = spring_constant_[kIdx] * actual_length_[kIdx] /</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                            (tension_[kIdx] + spring_constant_[kIdx]);</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="comment">// .... and volume_</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    UpdateVolume();</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="comment">// and local coord</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    UpdateLocalCoordinateAxis();</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    proximal_ne-&gt;RemoveFromSimulation();</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;  }</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div>
<div class="line"><a name="l01642"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a9ad736863fa0e984d7e5e77b4c98a2ef"> 1642</a></span>&#160;  MostDerivedSoPtr <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a9ad736863fa0e984d7e5e77b4c98a2ef">ExtendSideNeuriteElement</a>(</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;      <span class="keywordtype">double</span> length, <span class="keywordtype">double</span> diameter, <span class="keyword">const</span> std::array&lt;double, 3&gt;&amp; direction) {</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordflow">if</span> (daughter_right_[kIdx] != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      Fatal(</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;          <span class="stringliteral">&quot;NeuriteElement&quot;</span>,</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;          <span class="stringliteral">&quot;Can&#39;t extend a side neurite since daughter_right is not a nullptr!&quot;</span>);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    }</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <span class="keyword">auto</span>* rm = Simulation_t::GetActive()-&gt;GetResourceManager();</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <a class="code" href="structbdm_1_1experimental_1_1neuroscience_1_1SideNeuriteExtensionEvent.html">SideNeuriteExtensionEvent</a> <span class="keyword">event</span> = {length, diameter, direction};</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <span class="keyword">auto</span>&amp;&amp; new_branch = rm-&gt;template New&lt;MostDerivedScalar&gt;(event, ThisMD());</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    ThisMD()-&gt;EventHandler(event, &amp;new_branch);</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <span class="keywordflow">return</span> new_branch.GetSoPtr();</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  }</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TEvent, <span class="keyword">typename</span> TNeuriteElement&gt;</div>
<div class="line"><a name="l01662"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a55b0f28adc9ff338da6e91e4d667a839"> 1662</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a55b0f28adc9ff338da6e91e4d667a839">InitializeSplitOrBranching</a>(<span class="keyword">const</span> TEvent&amp; event, TNeuriteElement* other) {</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <span class="keyword">auto</span>* param = Simulation_t::GetActive()-&gt;GetParam();</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    tension_[kIdx] = param-&gt;neurite_default_tension_;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    diameter_[kIdx] = param-&gt;neurite_default_diameter_;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    actual_length_[kIdx] = param-&gt;neurite_default_actual_length_;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    density_[kIdx] = param-&gt;neurite_default_density_;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    spring_constant_[kIdx] = param-&gt;neurite_default_spring_constant_;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    adherence_[kIdx] = param-&gt;neurite_default_adherence_;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="keywordtype">double</span> distal_portion = <span class="keyword">event</span>.distal_portion_;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; other_ml = other-&gt;GetMassLocation();</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; other_sa = other-&gt;GetSpringAxis();</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; other_rl = other-&gt;GetRestingLength();</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="keyword">auto</span>&amp; mother_bms = other-&gt;biology_modules_[other-&gt;kIdx];</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="comment">// TODO(neurites) reformulate to mass_location_</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="keyword">auto</span> new_position =</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        <a class="code" href="structbdm_1_1Math.html#a80c38cbb986a66639c5ff0ccfce5674e">Math::Subtract</a>(other_ml, <a class="code" href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">Math::ScalarMult</a>(distal_portion, other_sa));</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    SetPosition(new_position);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    Copy(*other);</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="comment">// family relations</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    SetMother(other-&gt;GetMother());</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    SetDaughterLeft(other-&gt;GetSoPtr());</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="comment">// physics</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    resting_length_[kIdx] = ((1 - distal_portion) * other_rl);</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <span class="comment">// copy biology_modules_ to me</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="keyword">auto</span>&amp; my_bms = biology_modules_[kIdx];</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <a class="code" href="namespacebdm.html#a4c062c6bcddf1e43dd406a65cfa451eb">CopyBiologyModules</a>(event, &amp;mother_bms, &amp;my_bms);</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  }</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TEvent, <span class="keyword">typename</span> TNeuriteElement&gt;</div>
<div class="line"><a name="l01702"></a><span class="lineno"><a class="line" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a3df5fbd6c035b72fe06e81296606b3cc"> 1702</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a3df5fbd6c035b72fe06e81296606b3cc">InitializeSideExtensionOrBranching</a>(<span class="keyword">const</span> TEvent&amp; event,</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                                          TNeuriteElement* mother) {</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="keyword">auto</span>* param = Simulation_t::GetActive()-&gt;GetParam();</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    tension_[kIdx] = param-&gt;neurite_default_tension_;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    diameter_[kIdx] = param-&gt;neurite_default_diameter_;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    actual_length_[kIdx] = param-&gt;neurite_default_actual_length_;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    density_[kIdx] = param-&gt;neurite_default_density_;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    spring_constant_[kIdx] = param-&gt;neurite_default_spring_constant_;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    adherence_[kIdx] = param-&gt;neurite_default_adherence_;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    <span class="keywordtype">double</span> length = <span class="keyword">event</span>.length_;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="keywordtype">double</span> diameter = <span class="keyword">event</span>.diameter_;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; direction = <span class="keyword">event</span>.direction_;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    Copy(*mother);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <span class="keyword">auto</span> dir = direction;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; mother_spring_axis = mother-&gt;GetSpringAxis();</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <span class="keywordtype">double</span> angle_with_side_branch =</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        <a class="code" href="structbdm_1_1Math.html#aa8ecbf6af44a29c3f314ab97a1c53f20">Math::AngleRadian</a>(mother_spring_axis, direction);</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <span class="keywordflow">if</span> (angle_with_side_branch &lt; 0.78 ||</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        angle_with_side_branch &gt; 2.35) {  <span class="comment">// 45-135 degrees</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;      <span class="keyword">auto</span> p = <a class="code" href="structbdm_1_1Math.html#abfb252b62698eaa4176ec9a83e89bf37">Math::CrossProduct</a>(mother_spring_axis, direction);</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;      p = <a class="code" href="structbdm_1_1Math.html#abfb252b62698eaa4176ec9a83e89bf37">Math::CrossProduct</a>(p, mother_spring_axis);</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      dir = <a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(<a class="code" href="structbdm_1_1Math.html#a06cf62fd723d1775714117f3d42cc0d4">Math::Normalize</a>(direction), <a class="code" href="structbdm_1_1Math.html#a06cf62fd723d1775714117f3d42cc0d4">Math::Normalize</a>(p));</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    }</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <span class="comment">// location of mass and computation center</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="keyword">auto</span> new_spring_axis = <a class="code" href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">Math::ScalarMult</a>(length, <a class="code" href="structbdm_1_1Math.html#a06cf62fd723d1775714117f3d42cc0d4">Math::Normalize</a>(direction));</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; mother_ml = mother-&gt;GetMassLocation();</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    SetMassLocation(<a class="code" href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">Math::Add</a>(mother_ml, new_spring_axis));</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    SetSpringAxis(new_spring_axis);</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="comment">// physics</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    SetActualLength(length);</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    SetRestingLengthForDesiredTension(param-&gt;neurite_default_tension_);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    SetDiameter(param-&gt;neurite_default_diameter_);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    UpdateLocalCoordinateAxis();</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="comment">// family relations</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    SetMother(mother-&gt;GetSoPtr());</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="comment">// biological modules</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="keyword">auto</span>&amp; mother_bms = mother-&gt;biology_modules_[mother-&gt;kIdx];</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <span class="comment">// copy biology_modules_ to me</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="keyword">auto</span>&amp; my_bms = biology_modules_[kIdx];</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <a class="code" href="namespacebdm.html#a4c062c6bcddf1e43dd406a65cfa451eb">CopyBiologyModules</a>(event, &amp;mother_bms, &amp;my_bms);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    branch_order_[kIdx] = mother-&gt;GetBranchOrder() + 1;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    diameter_[kIdx] = diameter;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="comment">// correct physical values (has to be after family relations</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    UpdateDependentPhysicalVariables();</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  }</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;};</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;}  <span class="comment">// namespace neuroscience</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;}  <span class="comment">// namespace experimental</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;}  <span class="comment">// namespace bdm</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;<span class="preprocessor">#endif  // NEUROSCIENCE_NEURITE_ELEMENT_H_</span></div>
<div class="ttc" id="side__neurite__extension__event_8h_html"><div class="ttname"><a href="side__neurite__extension__event_8h.html">side_neurite_extension_event.h</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a5034a8b639090e948131064c701bde46"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a5034a8b639090e948131064c701bde46">bdm::experimental::neuroscience::NeuriteElementExt::Bifurcate</a></div><div class="ttdeci">std::array&lt; MostDerivedSoPtr, 2 &gt; Bifurcate(double length, double diameter_1, double diameter_2, const std::array&lt; double, 3 &gt; &amp;direction_1, const std::array&lt; double, 3 &gt; &amp;direction_2)</div><div class="ttdoc">Growth cone bifurcation. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00678">neurite_element.h:678</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a6cf852c22bf3f671bea5b6a0a9a868e1"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a6cf852c22bf3f671bea5b6a0a9a868e1">bdm::experimental::neuroscience::NeuriteElementExt::RetractTerminalEnd</a></div><div class="ttdeci">void RetractTerminalEnd(double speed)</div><div class="ttdoc">TODO(neurites) generated end`. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00546">neurite_element.h:546</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a45d0d4d0a5bcb6cbbbe639eb2c58e9ae"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a45d0d4d0a5bcb6cbbbe639eb2c58e9ae">bdm::experimental::neuroscience::NeuriteElementExt::EventHandler</a></div><div class="ttdeci">void EventHandler(const NeuriteBranchingEvent &amp;event, TNeuriteElement *proximal, TNeuriteElement *branch)</div><div class="ttdoc">EventHandler to modify the neurite element that triggered the branching event. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01509">neurite_element.h:1509</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_ad6f82c4911cbdcdbe927ef69ee829458"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ad6f82c4911cbdcdbe927ef69ee829458">bdm::experimental::neuroscience::NeuronNeuriteAdapter::UpdateDependentPhysicalVariables</a></div><div class="ttdeci">void UpdateDependentPhysicalVariables()</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00142">neurite_element.h:142</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a4ecdf160a7621f5a0d667734ffd7b247"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a4ecdf160a7621f5a0d667734ffd7b247">bdm::experimental::neuroscience::NeuriteElementExt::SetRestingLength</a></div><div class="ttdeci">void SetRestingLength(double resting_length)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01295">neurite_element.h:1295</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a3df5fbd6c035b72fe06e81296606b3cc"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a3df5fbd6c035b72fe06e81296606b3cc">bdm::experimental::neuroscience::NeuriteElementExt::InitializeSideExtensionOrBranching</a></div><div class="ttdeci">void InitializeSideExtensionOrBranching(const TEvent &amp;event, TNeuriteElement *mother)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01702">neurite_element.h:1702</a></div></div>
<div class="ttc" id="structbdm_1_1experimental_1_1neuroscience_1_1SideNeuriteExtensionEvent_html"><div class="ttname"><a href="structbdm_1_1experimental_1_1neuroscience_1_1SideNeuriteExtensionEvent.html">bdm::experimental::neuroscience::SideNeuriteExtensionEvent</a></div><div class="ttdoc">Contains the parameters to add a side neurite element. </div><div class="ttdef"><b>Definition:</b> <a href="side__neurite__extension__event_8h_source.html#l00035">side_neurite_extension_event.h:35</a></div></div>
<div class="ttc" id="namespacebdm_html_a3b4c908b7fd30c77a880d0c2e86c570e"><div class="ttname"><a href="namespacebdm.html#a3b4c908b7fd30c77a880d0c2e86c570e">bdm::BiologyModuleEventHandler</a></div><div class="ttdeci">void BiologyModuleEventHandler(const TEvent &amp;event, TBiologyModules1 *current, TBiologyModules *...bms)</div><div class="ttdoc">Function to invoke the EventHandler of the biology module or remove it from current. Forwards the event handler call to each biology modules of the triggered simulation object and removes biology modules if they are flagged. </div><div class="ttdef"><b>Definition:</b> <a href="biology__module__util_8h_source.html#l00137">biology_module_util.h:137</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a49b5c5aae648531e663283e552109830"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a49b5c5aae648531e663283e552109830">bdm::experimental::neuroscience::NeuriteElementExt::GetDaughterLeft</a></div><div class="ttdeci">const MostDerivedSoPtr &amp; GetDaughterLeft() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01263">neurite_element.h:1263</a></div></div>
<div class="ttc" id="namespacebdm_html_a3037f55bcb7f13fc1580dfb578dec3ee"><div class="ttname"><a href="namespacebdm.html#a3037f55bcb7f13fc1580dfb578dec3ee">bdm::Shape</a></div><div class="ttdeci">Shape</div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00020">shape.h:20</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_aaaf4aaa3a79e12dbb36b4ccf1b717dab"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aaaf4aaa3a79e12dbb36b4ccf1b717dab">bdm::experimental::neuroscience::NeuriteElementExt::GetMass</a></div><div class="ttdeci">double GetMass() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00483">neurite_element.h:483</a></div></div>
<div class="ttc" id="simulation__object__util_8h_html_a1b9f7ea7c3d696427b4d429ff4dd6bab"><div class="ttname"><a href="simulation__object__util_8h.html#a1b9f7ea7c3d696427b4d429ff4dd6bab">BDM_SIM_OBJECT</a></div><div class="ttdeci">#define BDM_SIM_OBJECT(sim_object, base_class)</div><div class="ttdef"><b>Definition:</b> <a href="simulation__object__util_8h_source.html#l00103">simulation_object_util.h:103</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a84da3c6a74827b6ae6f622716c6bd328"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a84da3c6a74827b6ae6f622716c6bd328">bdm::experimental::neuroscience::NeuriteElementExt::MovePointMass</a></div><div class="ttdeci">void MovePointMass(double speed, const std::array&lt; double, 3 &gt; &amp;direction)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00844">neurite_element.h:844</a></div></div>
<div class="ttc" id="neurite__bifurcation__event_8h_html"><div class="ttname"><a href="neurite__bifurcation__event_8h.html">neurite_bifurcation_event.h</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a575a2efaec2afb3085e3d1feae2065ba"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a575a2efaec2afb3085e3d1feae2065ba">bdm::experimental::neuroscience::NeuriteElementExt::BifurcationPermitted</a></div><div class="ttdeci">bool BifurcationPermitted() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00669">neurite_element.h:669</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a1ea404d14ba536d2fe7cb1f4c725531e"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a1ea404d14ba536d2fe7cb1f4c725531e">bdm::experimental::neuroscience::NeuriteElementExt::DistalEnd</a></div><div class="ttdeci">const std::array&lt; double, 3 &gt; &amp; DistalEnd() const </div><div class="ttdoc">Returns the position of the distal end == position_. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01337">neurite_element.h:1337</a></div></div>
<div class="ttc" id="structbdm_1_1Math_html_aed3c71a56eb984be1e7c318fa2056fb2"><div class="ttname"><a href="structbdm_1_1Math.html#aed3c71a56eb984be1e7c318fa2056fb2">bdm::Math::ScalarMult</a></div><div class="ttdeci">static std::array&lt; double, N &gt; ScalarMult(double k, const std::array&lt; double, N &gt; &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="math__util_8h_source.html#l00078">math_util.h:78</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a426f841fc5f81b40e36e759051c3b5c1"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a426f841fc5f81b40e36e759051c3b5c1">bdm::experimental::neuroscience::NeuriteElementExt::GetDiameter</a></div><div class="ttdeci">double GetDiameter() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00479">neurite_element.h:479</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a44712e47cd760e0bbc736979aa64d110"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a44712e47cd760e0bbc736979aa64d110">bdm::experimental::neuroscience::NeuriteElementExt::IsAxon</a></div><div class="ttdeci">bool IsAxon() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01251">neurite_element.h:1251</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a3ff53e941df9379f56fbab9cd23e469a"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a3ff53e941df9379f56fbab9cd23e469a">bdm::experimental::neuroscience::NeuriteElementExt::EventHandler</a></div><div class="ttdeci">void EventHandler(const NeuriteBifurcationEvent &amp;event, TDaughter *left, TDaughter *right)</div><div class="ttdoc">EventHandler to modify the terminal element that triggered the bifurcation event. ...</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01450">neurite_element.h:1450</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a42e85374e2c654a14c3131b8be168899"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a42e85374e2c654a14c3131b8be168899">bdm::experimental::neuroscience::NeuriteElementExt::Branch</a></div><div class="ttdeci">MostDerivedSoPtr Branch(double new_branch_diameter, const std::array&lt; double, 3 &gt; &amp;direction, double length=1.0)</div><div class="ttdoc">Create a branch for this neurite element. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00615">neurite_element.h:615</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a9f2bd88dfdacdc01c8f541e2309c4e19"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a9f2bd88dfdacdc01c8f541e2309c4e19">bdm::experimental::neuroscience::NeuriteElementExt::AddBiologyModule</a></div><div class="ttdeci">void AddBiologyModule(TBiologyModule &amp;&amp;module)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00513">neurite_element.h:513</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_aa6a1add571cae1ffb1271efa9af3d40f"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#aa6a1add571cae1ffb1271efa9af3d40f">bdm::experimental::neuroscience::NeuronNeuriteAdapter::Set</a></div><div class="ttdeci">std::enable_if&lt; is_same&lt; T, TNeuriteElementSoPtr &gt;::value &gt;::type Set(T &amp;&amp;soptr)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00078">neurite_element.h:78</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_aca6c5356ac82eb01a3796f256dabfb52"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aca6c5356ac82eb01a3796f256dabfb52">bdm::experimental::neuroscience::NeuriteElementExt::MostDerived</a></div><div class="ttdeci">typename TDerived::template type&lt; typename TCompileTimeParam::template Self&lt; TTBackend &gt;, TDerived &gt; MostDerived</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00222">neurite_element.h:222</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_aa0c38cd27aaed367ae2c4f75932702c3"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa0c38cd27aaed367ae2c4f75932702c3">bdm::experimental::neuroscience::NeuriteElementExt::ChangeDiameter</a></div><div class="ttdeci">void ChangeDiameter(double speed)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00899">neurite_element.h:899</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_ae41e75fb8eda7a3ab3d0dd6f02421c40"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ae41e75fb8eda7a3ab3d0dd6f02421c40">bdm::experimental::neuroscience::NeuriteElementExt::GetBranchOrder</a></div><div class="ttdeci">int GetBranchOrder() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01282">neurite_element.h:1282</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_a77a590be0976ceb0b0dce335b973b0f3"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a77a590be0976ceb0b0dce335b973b0f3">bdm::experimental::neuroscience::NeuronNeuriteAdapter::Set</a></div><div class="ttdeci">std::enable_if&lt; is_same&lt; T, TNeuronSomaSoPtr &gt;::value &gt;::type Set(T &amp;&amp;soptr)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00072">neurite_element.h:72</a></div></div>
<div class="ttc" id="structbdm_1_1Math_html_aa8ecbf6af44a29c3f314ab97a1c53f20"><div class="ttname"><a href="structbdm_1_1Math.html#aa8ecbf6af44a29c3f314ab97a1c53f20">bdm::Math::AngleRadian</a></div><div class="ttdeci">static double AngleRadian(const std::array&lt; double, 3 &gt; &amp;a, const std::array&lt; double, 3 &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="math__util_8h_source.html#l00190">math_util.h:190</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a6eb70a443297042b8e4435479a496b4e"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a6eb70a443297042b8e4435479a496b4e">bdm::experimental::neuroscience::NeuriteElementExt::SetDaughterLeft</a></div><div class="ttdeci">void SetDaughterLeft(const MostDerivedSoPtr &amp;daughter)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01267">neurite_element.h:1267</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_ac852537d04e2b5c8ecbc603f778295af"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ac852537d04e2b5c8ecbc603f778295af">bdm::experimental::neuroscience::NeuriteElementExt::ElongateTerminalEnd</a></div><div class="ttdeci">void ElongateTerminalEnd(double speed, const std::array&lt; double, 3 &gt; &amp;direction)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00598">neurite_element.h:598</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_ad8c7f4af2ee3ffc1d11d365618975fc0"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ad8c7f4af2ee3ffc1d11d365618975fc0">bdm::experimental::neuroscience::NeuriteElementExt::GetSpringAxis</a></div><div class="ttdeci">const std::array&lt; double, 3 &gt; &amp; GetSpringAxis() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01299">neurite_element.h:1299</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a05e4d24ea9ecedee749cacce199a4af9"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a05e4d24ea9ecedee749cacce199a4af9">bdm::experimental::neuroscience::NeuriteElementExt::UpdateLocalCoordinateAxis</a></div><div class="ttdeci">void UpdateLocalCoordinateAxis()</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01119">neurite_element.h:1119</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_ab95ca95765e53c030e9b147ec34eab41"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ab95ca95765e53c030e9b147ec34eab41">bdm::experimental::neuroscience::NeuriteElementExt::SetTension</a></div><div class="ttdeci">void SetTension(double tension)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01315">neurite_element.h:1315</a></div></div>
<div class="ttc" id="new__neurite__extension__event_8h_html"><div class="ttname"><a href="new__neurite__extension__event_8h.html">new_neurite_extension_event.h</a></div></div>
<div class="ttc" id="structbdm_1_1Math_html_a06cf62fd723d1775714117f3d42cc0d4"><div class="ttname"><a href="structbdm_1_1Math.html#a06cf62fd723d1775714117f3d42cc0d4">bdm::Math::Normalize</a></div><div class="ttdeci">static std::array&lt; double, 3 &gt; Normalize(const std::array&lt; double, 3 &gt; &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="math__util_8h_source.html#l00106">math_util.h:106</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_adfd6c42e932ef402bedf9b7952375d6c"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#adfd6c42e932ef402bedf9b7952375d6c">bdm::experimental::neuroscience::NeuriteElementExt::SetActualLength</a></div><div class="ttdeci">void SetActualLength(double actual_length)</div><div class="ttdoc">Should not be used, since the actual length depends on the geometry. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01289">neurite_element.h:1289</a></div></div>
<div class="ttc" id="neuroscience_2param_8h_html"><div class="ttname"><a href="neuroscience_2param_8h.html">param.h</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_ada9bfaab59827023fb40e58e468e95ca"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ada9bfaab59827023fb40e58e468e95ca">bdm::experimental::neuroscience::NeuriteElementExt::UpdateVolume</a></div><div class="ttdeci">void UpdateVolume()</div><div class="ttdoc">Recomputes volume, after diameter has been change. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01145">neurite_element.h:1145</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a3ce0aa920133b0abf451c45b70187973"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a3ce0aa920133b0abf451c45b70187973">bdm::experimental::neuroscience::NeuriteElementExt::UpdateDiameter</a></div><div class="ttdeci">void UpdateDiameter()</div><div class="ttdoc">Recomputes diameter after volume has changed. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01139">neurite_element.h:1139</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_aa0afb8714114c79f6f75b9f6da486f05"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa0afb8714114c79f6f75b9f6da486f05">bdm::experimental::neuroscience::NeuriteElementExt::SetSpringAxis</a></div><div class="ttdeci">void SetSpringAxis(const std::array&lt; double, 3 &gt; &amp;axis)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01303">neurite_element.h:1303</a></div></div>
<div class="ttc" id="structbdm_1_1RunVisitor_html"><div class="ttname"><a href="structbdm_1_1RunVisitor.html">bdm::RunVisitor</a></div><div class="ttdoc">Visitor to execute the Run method of a biology module. </div><div class="ttdef"><b>Definition:</b> <a href="biology__module__util_8h_source.html#l00098">biology_module_util.h:98</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a2819596608096310568d593b63ff1553"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a2819596608096310568d593b63ff1553">bdm::experimental::neuroscience::NeuriteElementExt::Copy</a></div><div class="ttdeci">void Copy(const MostDerived&lt; TBackend &gt; &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01427">neurite_element.h:1427</a></div></div>
<div class="ttc" id="classbdm_1_1DefaultForce_html_a9bb58e49a1f7c999c3d022659a71958a"><div class="ttname"><a href="classbdm_1_1DefaultForce.html#a9bb58e49a1f7c999c3d022659a71958a">bdm::DefaultForce::GetForce</a></div><div class="ttdeci">std::enable_if&lt; TLhs::GetShape()==kSphere &amp;&amp;TRhs::GetShape()==kSphere, std::array&lt; double, 3 &gt; &gt;::type GetForce(const TLhs *lhs, const TRhs *rhs) const </div><div class="ttdef"><b>Definition:</b> <a href="default__force_8h_source.html#l00041">default_force.h:41</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_aa62110b09373e6f2f4933f3c0ebf6e07"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa62110b09373e6f2f4933f3c0ebf6e07">bdm::experimental::neuroscience::NeuriteElementExt::Bifurcate</a></div><div class="ttdeci">std::array&lt; MostDerivedSoPtr, 2 &gt; Bifurcate(const std::array&lt; double, 3 &gt; &amp;direction_1, const std::array&lt; double, 3 &gt; &amp;direction_2)</div><div class="ttdoc">Growth cone bifurcation. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00710">neurite_element.h:710</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a62706f0957d9ba31171cdd35f19e3ae7"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a62706f0957d9ba31171cdd35f19e3ae7">bdm::experimental::neuroscience::NeuriteElementExt::CalculateDisplacement</a></div><div class="ttdeci">std::array&lt; double, 3 &gt; CalculateDisplacement(TGrid *grid, double squared_radius)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00913">neurite_element.h:913</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a68e12f41972d921dc7ee44ffd3bd40e8"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a68e12f41972d921dc7ee44ffd3bd40e8">bdm::experimental::neuroscience::NeuriteElementExt::SetBranchOrder</a></div><div class="ttdeci">void SetBranchOrder(int branch_order)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01284">neurite_element.h:1284</a></div></div>
<div class="ttc" id="simulation__object__util_8h_html"><div class="ttname"><a href="simulation__object__util_8h.html">simulation_object_util.h</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_ad4cd0147def1cd6706ebfaa95bccd9c3"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ad4cd0147def1cd6706ebfaa95bccd9c3">bdm::experimental::neuroscience::NeuriteElementExt::SetMassLocation</a></div><div class="ttdeci">void SetMassLocation(const std::array&lt; double, 3 &gt; &amp;mass_location)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00465">neurite_element.h:465</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_ad223eb0b69f2258c580934acf4f89915"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ad223eb0b69f2258c580934acf4f89915">bdm::experimental::neuroscience::NeuronNeuriteAdapter::UpdateRelative</a></div><div class="ttdeci">void UpdateRelative(const TNeuronOrNeurite &amp;old_rel, const TNeuronOrNeurite &amp;new_rel)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00153">neurite_element.h:153</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_ae2ffe7cc3a2c157cda3cbd2819f3a6d1"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ae2ffe7cc3a2c157cda3cbd2819f3a6d1">bdm::experimental::neuroscience::NeuronNeuriteAdapter::IsNeuriteElement</a></div><div class="ttdeci">bool IsNeuriteElement() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00112">neurite_element.h:112</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a95ae83512824f8a0235c6a1796d871a1"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a95ae83512824f8a0235c6a1796d871a1">bdm::experimental::neuroscience::NeuriteElementExt::SetAdherence</a></div><div class="ttdeci">void SetAdherence(double adherence)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00471">neurite_element.h:471</a></div></div>
<div class="ttc" id="namespacebdm_html_a0afb3104a493a1bbe226d5d8941dedb6"><div class="ttname"><a href="namespacebdm.html#a0afb3104a493a1bbe226d5d8941dedb6">bdm::visit</a></div><div class="ttdeci">void visit(TFunction &amp;&amp;function, TVariant &amp;&amp;variant_wrapper)</div><div class="ttdef"><b>Definition:</b> <a href="variant_8h_source.html#l00033">variant.h:33</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_aec081ad14324afdc58fbd1984ac42623"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aec081ad14324afdc58fbd1984ac42623">bdm::experimental::neuroscience::NeuriteElementExt::EventHandler</a></div><div class="ttdeci">void EventHandler(const SplitNeuriteElementEvent &amp;event, TNeurite *proximal)</div><div class="ttdoc">EventHandler to modify the data members of this neurite element after an insert proximal neurite elem...</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01483">neurite_element.h:1483</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a8acc432d3f78b8bdf0bbf5129380de4a"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a8acc432d3f78b8bdf0bbf5129380de4a">bdm::experimental::neuroscience::NeuriteElementExt::UpdateDependentPhysicalVariables</a></div><div class="ttdeci">void UpdateDependentPhysicalVariables()</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01369">neurite_element.h:1369</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a76c39fd1d3a4fd43f999be9e7181c7ba"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a76c39fd1d3a4fd43f999be9e7181c7ba">bdm::experimental::neuroscience::NeuriteElementExt::UpdateRelative</a></div><div class="ttdeci">void UpdateRelative(const NeuriteOrNeuron &amp;old_relative, const NeuriteOrNeuron &amp;new_relative)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00765">neurite_element.h:765</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_afe134e11979dae060b4c66fbf9d28dc9"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#afe134e11979dae060b4c66fbf9d28dc9">bdm::experimental::neuroscience::NeuriteElementExt::GetVolume</a></div><div class="ttdeci">double GetVolume() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00477">neurite_element.h:477</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a86aeb3c31ce064028d44a564046e621b"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a86aeb3c31ce064028d44a564046e621b">bdm::experimental::neuroscience::NeuriteElementExt::NeuriteElementExt</a></div><div class="ttdeci">NeuriteElementExt(const NeuriteBranchingEvent &amp;event, TNeuriteElement *other, uint64_t new_oid)</div><div class="ttdoc">This constructor is used to create a proximal neurite element, or a side neurite element for a neurit...</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00411">neurite_element.h:411</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_a3a7f8c6d3f6123d803fb665c678f0c12"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a3a7f8c6d3f6123d803fb665c678f0c12">bdm::experimental::neuroscience::NeuronNeuriteAdapter::GetDaughterLeft</a></div><div class="ttdeci">auto GetDaughterLeft() -&gt; decltype(std::declval&lt; TNeuriteElementSoPtr &gt;() -&gt;GetDaughterLeft()) const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00121">neurite_element.h:121</a></div></div>
<div class="ttc" id="structbdm_1_1experimental_1_1neuroscience_1_1SplitNeuriteElementEvent_html"><div class="ttname"><a href="structbdm_1_1experimental_1_1neuroscience_1_1SplitNeuriteElementEvent.html">bdm::experimental::neuroscience::SplitNeuriteElementEvent</a></div><div class="ttdoc">Contains the parameters to split a neurite element into two segments. </div><div class="ttdef"><b>Definition:</b> <a href="split__neurite__element__event_8h_source.html#l00036">split_neurite_element_event.h:36</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_ad71da6765196de401d1546833939c28d"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ad71da6765196de401d1546833939c28d">bdm::experimental::neuroscience::NeuriteElementExt::GetSpringConstant</a></div><div class="ttdeci">double GetSpringConstant() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01307">neurite_element.h:1307</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_ae00e139f23595f2982c63f7d9e982211"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ae00e139f23595f2982c63f7d9e982211">bdm::experimental::neuroscience::NeuronNeuriteAdapter::GetNeuriteElementSoPtr</a></div><div class="ttdeci">const TNeuriteElementSoPtr &amp; GetNeuriteElementSoPtr() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00085">neurite_element.h:85</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_aac8c3a4ac11dcef1cbe20a7c567e614b"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aac8c3a4ac11dcef1cbe20a7c567e614b">bdm::experimental::neuroscience::NeuriteElementExt::RunBiologyModules</a></div><div class="ttdeci">void RunBiologyModules()</div><div class="ttdoc">Execute all biology modules. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00518">neurite_element.h:518</a></div></div>
<div class="ttc" id="structbdm_1_1Math_html_a39c5e7f5b49f38902ef63ae9f1215252"><div class="ttname"><a href="structbdm_1_1Math.html#a39c5e7f5b49f38902ef63ae9f1215252">bdm::Math::RotAroundAxis</a></div><div class="ttdeci">static std::array&lt; double, 3 &gt; RotAroundAxis(const std::array&lt; double, 3 &gt; &amp;vector, double theta, const std::array&lt; double, 3 &gt; &amp;axis)</div><div class="ttdef"><b>Definition:</b> <a href="math__util_8h_source.html#l00169">math_util.h:169</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_aa266f923a7de5cd15fc4194f2ebb5368"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#aa266f923a7de5cd15fc4194f2ebb5368">bdm::experimental::neuroscience::NeuronNeuriteAdapter::GetMother</a></div><div class="ttdeci">Self GetMother()</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00115">neurite_element.h:115</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_a8f555cd029b6589ed3d15a54fa729ba3"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a8f555cd029b6589ed3d15a54fa729ba3">bdm::experimental::neuroscience::NeuronNeuriteAdapter::IsNeuronSoma</a></div><div class="ttdeci">bool IsNeuronSoma() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00111">neurite_element.h:111</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_a43b27f25de413303e3eafd205d87c8bb"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a43b27f25de413303e3eafd205d87c8bb">bdm::experimental::neuroscience::NeuronNeuriteAdapter::GetDaughterRight</a></div><div class="ttdeci">auto GetDaughterRight() -&gt; decltype(std::declval&lt; TNeuriteElementSoPtr &gt;() -&gt;GetDaughterRight()) const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00128">neurite_element.h:128</a></div></div>
<div class="ttc" id="structbdm_1_1Math_html_a6e410e3dc82bab5dd53e0157df3587b2"><div class="ttname"><a href="structbdm_1_1Math.html#a6e410e3dc82bab5dd53e0157df3587b2">bdm::Math::Add</a></div><div class="ttdeci">static std::array&lt; T, N &gt; Add(const std::array&lt; T, N &gt; &amp;a, const std::array&lt; T, N &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="math__util_8h_source.html#l00036">math_util.h:36</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html">bdm::experimental::neuroscience::NeuriteElementExt</a></div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00216">neurite_element.h:216</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_ae7979df2131be770f008fe0c4addb87d"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ae7979df2131be770f008fe0c4addb87d">bdm::experimental::neuroscience::NeuriteElementExt::SetPosition</a></div><div class="ttdeci">void SetPosition(const std::array&lt; double, 3 &gt; &amp;position)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00455">neurite_element.h:455</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a966e5f87a034b7c5f3d77b2fc5b332a4"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a966e5f87a034b7c5f3d77b2fc5b332a4">bdm::experimental::neuroscience::NeuriteElementExt::GetYAxis</a></div><div class="ttdeci">const std::array&lt; double, 3 &gt; &amp; GetYAxis() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00474">neurite_element.h:474</a></div></div>
<div class="ttc" id="simulation__object_8h_html"><div class="ttname"><a href="simulation__object_8h.html">simulation_object.h</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_ad991b08ea5e0abb4698a6e46f4d18986"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ad991b08ea5e0abb4698a6e46f4d18986">bdm::experimental::neuroscience::NeuriteElementExt::Branch</a></div><div class="ttdeci">MostDerivedSoPtr Branch(const std::array&lt; double, 3 &gt; &amp;direction)</div><div class="ttdoc">Create a branch for this neurite element. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00633">neurite_element.h:633</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a94a70bc13d401f56b2b06bcef46eb123"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a94a70bc13d401f56b2b06bcef46eb123">bdm::experimental::neuroscience::NeuriteElementExt::ChangeVolume</a></div><div class="ttdeci">void ChangeVolume(double speed)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00884">neurite_element.h:884</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a1f19da92d69d9dea141df43c925a9066"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a1f19da92d69d9dea141df43c925a9066">bdm::experimental::neuroscience::NeuriteElementExt::LengthToProximalBranchingPoint</a></div><div class="ttdeci">double LengthToProximalBranchingPoint() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01346">neurite_element.h:1346</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_aa5a3ebfc78ecf0123985178bbc1c7902"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa5a3ebfc78ecf0123985178bbc1c7902">bdm::experimental::neuroscience::NeuriteElementExt::EventHandler</a></div><div class="ttdeci">void EventHandler(const SideNeuriteExtensionEvent &amp;event, TDaughter *right)</div><div class="ttdoc">EventHandler to modify the data members of this neurite after a side neurite element extension event...</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01467">neurite_element.h:1467</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_ab0bd41618aeeeee2bc5053b4f9cadad5"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ab0bd41618aeeeee2bc5053b4f9cadad5">bdm::experimental::neuroscience::NeuronNeuriteAdapter::GetNeuriteElementSoPtr</a></div><div class="ttdeci">TNeuriteElementSoPtr &amp; GetNeuriteElementSoPtr()</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00091">neurite_element.h:91</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a350477fabd5c335635541063828e65fd"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a350477fabd5c335635541063828e65fd">bdm::experimental::neuroscience::NeuriteElementExt::GetActualLength</a></div><div class="ttdeci">double GetActualLength() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01286">neurite_element.h:1286</a></div></div>
<div class="ttc" id="biology__module__util_8h_html"><div class="ttname"><a href="biology__module__util_8h.html">biology_module_util.h</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a71cb0646e8ab51d3601a3526d56ec720"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a71cb0646e8ab51d3601a3526d56ec720">bdm::experimental::neuroscience::NeuriteElementExt::NeuriteElementExt</a></div><div class="ttdeci">NeuriteElementExt(const NeuriteBifurcationEvent &amp;event, TNeuriteElement *mother, uint64_t new_oid)</div><div class="ttdoc">This constructor is used to create daughter left, or right for a neurite bifurcation event...</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00318">neurite_element.h:318</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_ab61966cfc922cada9e47fcc8e328deff"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ab61966cfc922cada9e47fcc8e328deff">bdm::experimental::neuroscience::NeuriteElementExt::ForceTransmittedFromDaugtherToMother</a></div><div class="ttdeci">std::array&lt; double, 3 &gt; ForceTransmittedFromDaugtherToMother(const NeuriteOrNeuron &amp;mother)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00783">neurite_element.h:783</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_ac8c264fb8344720469ca3bd59cba309a"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ac8c264fb8344720469ca3bd59cba309a">bdm::experimental::neuroscience::NeuriteElementExt::SetDiameter</a></div><div class="ttdeci">void SetDiameter(double diameter)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00443">neurite_element.h:443</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a57b1698159831da2e38971d6711d27d0"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a57b1698159831da2e38971d6711d27d0">bdm::experimental::neuroscience::NeuriteElementExt::TransformCoordinatesPolarToGlobal</a></div><div class="ttdeci">std::array&lt; double, 3 &gt; TransformCoordinatesPolarToGlobal(const std::array&lt; double, 2 &gt; &amp;position) const </div><div class="ttdoc">P -&gt; G : P -&gt; L, then L -&gt; G. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01229">neurite_element.h:1229</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_a0c63c0fb4e2ba6cba9b285d40f728b38"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0c63c0fb4e2ba6cba9b285d40f728b38">bdm::experimental::neuroscience::NeuronNeuriteAdapter::neuron_ptr_</a></div><div class="ttdeci">TNeuronSomaSoPtr neuron_ptr_</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00198">neurite_element.h:198</a></div></div>
<div class="ttc" id="classbdm_1_1SoHandle_html"><div class="ttname"><a href="classbdm_1_1SoHandle.html">bdm::SoHandle</a></div><div class="ttdef"><b>Definition:</b> <a href="resource__manager_8h_source.html#l00049">resource_manager.h:49</a></div></div>
<div class="ttc" id="neurite__branching__event_8h_html"><div class="ttname"><a href="neurite__branching__event_8h.html">neurite_branching_event.h</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a93a7d26c797ad57f9173f63c92b6484c"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a93a7d26c797ad57f9173f63c92b6484c">bdm::experimental::neuroscience::NeuriteElementExt::SetBoxIdx</a></div><div class="ttdeci">void SetBoxIdx(uint64_t idx)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00495">neurite_element.h:495</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a1416baf8adfb5e1fd4e1bb7ea0e1a1f0"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a1416baf8adfb5e1fd4e1bb7ea0e1a1f0">bdm::experimental::neuroscience::NeuriteElementExt::GetRestingLength</a></div><div class="ttdeci">double GetRestingLength() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01293">neurite_element.h:1293</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a4450d80772509a36ba58bfb857946fd6"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a4450d80772509a36ba58bfb857946fd6">bdm::experimental::neuroscience::NeuriteElementExt::TransformCoordinatesLocalToPolar</a></div><div class="ttdeci">std::array&lt; double, 3 &gt; TransformCoordinatesLocalToPolar(const std::array&lt; double, 3 &gt; &amp;position) const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01212">neurite_element.h:1212</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_a43078567816b252638799bae180c2af7"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a43078567816b252638799bae180c2af7">bdm::experimental::neuroscience::NeuronNeuriteAdapter::GetPosition</a></div><div class="ttdeci">const std::array&lt; double, 3 &gt; GetPosition() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00093">neurite_element.h:93</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a93cec9baba560ad9c4404e6f65b59a82"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a93cec9baba560ad9c4404e6f65b59a82">bdm::experimental::neuroscience::NeuriteElementExt::SetMother</a></div><div class="ttdeci">void SetMother(const NeuriteOrNeuron &amp;mother)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01259">neurite_element.h:1259</a></div></div>
<div class="ttc" id="classbdm_1_1SimulationObject_html"><div class="ttname"><a href="classbdm_1_1SimulationObject.html">bdm::SimulationObject</a></div><div class="ttdoc">Contains code required by all simulation objects. </div><div class="ttdef"><b>Definition:</b> <a href="simulation__object_8h_source.html#l00041">simulation_object.h:41</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_abb2a8a5f8566c5a87d75504dd1af2c98"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#abb2a8a5f8566c5a87d75504dd1af2c98">bdm::experimental::neuroscience::NeuriteElementExt::RunDiscretization</a></div><div class="ttdeci">void RunDiscretization()</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00808">neurite_element.h:808</a></div></div>
<div class="ttc" id="structbdm_1_1Math_html_a59ce6781aaf6ed4ee0c7648fd33f6b55"><div class="ttname"><a href="structbdm_1_1Math.html#a59ce6781aaf6ed4ee0c7648fd33f6b55">bdm::Math::kPi</a></div><div class="ttdeci">static constexpr double kPi</div><div class="ttdoc">value of pi </div><div class="ttdef"><b>Definition:</b> <a href="math__util_8h_source.html#l00029">math_util.h:29</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_af5cd210958e13be0e40d99abd5aa3b02"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#af5cd210958e13be0e40d99abd5aa3b02">bdm::experimental::neuroscience::NeuriteElementExt::ProximalEnd</a></div><div class="ttdeci">std::array&lt; double, 3 &gt; ProximalEnd() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01332">neurite_element.h:1332</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a5d1ca6b3880840e9b7f0aa36fc4374ee"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a5d1ca6b3880840e9b7f0aa36fc4374ee">bdm::experimental::neuroscience::NeuriteElementExt::GetLength</a></div><div class="ttdeci">double GetLength() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01356">neurite_element.h:1356</a></div></div>
<div class="ttc" id="namespacebdm_html_a4c062c6bcddf1e43dd406a65cfa451eb"><div class="ttname"><a href="namespacebdm.html#a4c062c6bcddf1e43dd406a65cfa451eb">bdm::CopyBiologyModules</a></div><div class="ttdeci">void CopyBiologyModules(const TEvent &amp;event, TSrcBms *src, TDestBms *dest)</div><div class="ttdoc">Function to copy biology modules from one structure to another. </div><div class="ttdef"><b>Definition:</b> <a href="biology__module__util_8h_source.html#l00119">biology_module_util.h:119</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_a1a1a30f2d46dbd50f3ddab29825a93bb"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a1a1a30f2d46dbd50f3ddab29825a93bb">bdm::experimental::neuroscience::NeuronNeuriteAdapter::NeuronNeuriteAdapter</a></div><div class="ttdeci">NeuronNeuriteAdapter(T &amp;&amp;soptr, typename std::enable_if&lt; is_same&lt; T, TNeuriteElementSoPtr &gt;::value &gt;::type *p=0)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00064">neurite_element.h:64</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a6f4153e0d6bdbcc171d50a57fc1d46f4"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a6f4153e0d6bdbcc171d50a57fc1d46f4">bdm::experimental::neuroscience::NeuriteElementExt::NeuriteElementExt</a></div><div class="ttdeci">NeuriteElementExt(const SideNeuriteExtensionEvent &amp;event, TNeuriteElement *mother, uint64_t new_oid=0)</div><div class="ttdoc">This constructor is used to create a side neurite element for a side neurite extension event...</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00387">neurite_element.h:387</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_afbebe406dcc221de6c35bda76510f315"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#afbebe406dcc221de6c35bda76510f315">bdm::experimental::neuroscience::NeuriteElementExt::NeuriteElementExt</a></div><div class="ttdeci">NeuriteElementExt()</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00239">neurite_element.h:239</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_a549b8747c20cad1ac5820f52e5bcc182"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a549b8747c20cad1ac5820f52e5bcc182">bdm::experimental::neuroscience::NeuronNeuriteAdapter::RemoveFromSimulation</a></div><div class="ttdeci">auto RemoveFromSimulation() -&gt; decltype(std::declval&lt; TNeuriteElementSoPtr &gt;() -&gt;RemoveFromSimulation()) const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00167">neurite_element.h:167</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a887391d924ff8c300c7d8938e5f0db58"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a887391d924ff8c300c7d8938e5f0db58">bdm::experimental::neuroscience::NeuriteElementExt::SplitNeuriteElement</a></div><div class="ttdeci">MostDerivedSoPtr SplitNeuriteElement(double distal_portion=0.5)</div><div class="ttdoc">Split this neurite element into two segments. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01594">neurite_element.h:1594</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a55b0f28adc9ff338da6e91e4d667a839"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a55b0f28adc9ff338da6e91e4d667a839">bdm::experimental::neuroscience::NeuriteElementExt::InitializeSplitOrBranching</a></div><div class="ttdeci">void InitializeSplitOrBranching(const TEvent &amp;event, TNeuriteElement *other)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01662">neurite_element.h:1662</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_aba6e4cddfe735f9ac2482806678adff2"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aba6e4cddfe735f9ac2482806678adff2">bdm::experimental::neuroscience::NeuriteElementExt::SetAxon</a></div><div class="ttdeci">void SetAxon(bool is_axon)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01253">neurite_element.h:1253</a></div></div>
<div class="ttc" id="structbdm_1_1experimental_1_1neuroscience_1_1NeuriteBifurcationEvent_html"><div class="ttname"><a href="structbdm_1_1experimental_1_1neuroscience_1_1NeuriteBifurcationEvent.html">bdm::experimental::neuroscience::NeuriteBifurcationEvent</a></div><div class="ttdoc">Contains the parameters to bifurcate a growth cone. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__bifurcation__event_8h_source.html#l00038">neurite_bifurcation_event.h:38</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a2be8674a74cdafb7f0c1cfd598687a0e"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a2be8674a74cdafb7f0c1cfd598687a0e">bdm::experimental::neuroscience::NeuriteElementExt::SetDaughterRight</a></div><div class="ttdeci">void SetDaughterRight(const MostDerivedSoPtr &amp;daughter)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01278">neurite_element.h:1278</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_aa33c006b17130fd5e73767f659f3c24a"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa33c006b17130fd5e73767f659f3c24a">bdm::experimental::neuroscience::NeuriteElementExt::GetDensity</a></div><div class="ttdeci">double GetDensity() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00481">neurite_element.h:481</a></div></div>
<div class="ttc" id="namespacebdm_1_1experimental_1_1neuroscience_html_a19a8647c1380b168f90512da31ce4754"><div class="ttname"><a href="namespacebdm_1_1experimental_1_1neuroscience.html#a19a8647c1380b168f90512da31ce4754">bdm::experimental::neuroscience::NeuronSoma</a></div><div class="ttdeci">NeuronSomaExt&lt; CompileTimeParam&lt; Scalar &gt;, Capsule&lt; NeuronSomaExt &gt;&gt; NeuronSoma</div><div class="ttdef"><b>Definition:</b> <a href="neuron__soma_8h_source.html#l00031">neuron_soma.h:31</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a04560b9cb9811940e8c0ab1e116a5ac7"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a04560b9cb9811940e8c0ab1e116a5ac7">bdm::experimental::neuroscience::NeuriteElementExt::GetAxis</a></div><div class="ttdeci">const std::array&lt; double, 3 &gt; &amp; GetAxis() const </div><div class="ttdoc">Returns the axis direction of a neurite element. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01359">neurite_element.h:1359</a></div></div>
<div class="ttc" id="classbdm_1_1DefaultForce_html"><div class="ttname"><a href="classbdm_1_1DefaultForce.html">bdm::DefaultForce</a></div><div class="ttdef"><b>Definition:</b> <a href="default__force_8h_source.html#l00030">default_force.h:30</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_a5301b6d222ab297546f079f5617917f2"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a5301b6d222ab297546f079f5617917f2">bdm::experimental::neuroscience::NeuronNeuriteAdapter::GetRestingLength</a></div><div class="ttdeci">auto GetRestingLength() -&gt; decltype(std::declval&lt; TNeuriteElementSoPtr &gt;() -&gt;GetRestingLength()) const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00135">neurite_element.h:135</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_a6186b4d8f398e88f424a6fa7993d3b7c"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a6186b4d8f398e88f424a6fa7993d3b7c">bdm::experimental::neuroscience::NeuronNeuriteAdapter::NeuronNeuriteAdapter</a></div><div class="ttdeci">NeuronNeuriteAdapter()</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00053">neurite_element.h:53</a></div></div>
<div class="ttc" id="structbdm_1_1Math_html_a80c38cbb986a66639c5ff0ccfce5674e"><div class="ttname"><a href="structbdm_1_1Math.html#a80c38cbb986a66639c5ff0ccfce5674e">bdm::Math::Subtract</a></div><div class="ttdeci">static std::array&lt; T, N &gt; Subtract(const std::array&lt; T, N &gt; &amp;a, const std::array&lt; T, N &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="math__util_8h_source.html#l00050">math_util.h:50</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a6039e6d47bcd78dc27ac6ab67866a23c"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a6039e6d47bcd78dc27ac6ab67866a23c">bdm::experimental::neuroscience::NeuriteElementExt::GetMassLocation</a></div><div class="ttdeci">const std::array&lt; double, 3 &gt; &amp; GetMassLocation() const </div><div class="ttdoc">return end of neurite element position </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00461">neurite_element.h:461</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a8af344ef91ad0bb20ccdb52ccfaf3c43"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a8af344ef91ad0bb20ccdb52ccfaf3c43">bdm::experimental::neuroscience::NeuriteElementExt::GetDaughterRight</a></div><div class="ttdeci">const MostDerivedSoPtr &amp; GetDaughterRight() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01274">neurite_element.h:1274</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a78eee73a48c5bae5b0b2ee359e3bd527"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a78eee73a48c5bae5b0b2ee359e3bd527">bdm::experimental::neuroscience::NeuriteElementExt::RemoveProximalNeuriteElement</a></div><div class="ttdeci">void RemoveProximalNeuriteElement()</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01605">neurite_element.h:1605</a></div></div>
<div class="ttc" id="structbdm_1_1experimental_1_1neuroscience_1_1NeuriteBranchingEvent_html"><div class="ttname"><a href="structbdm_1_1experimental_1_1neuroscience_1_1NeuriteBranchingEvent.html">bdm::experimental::neuroscience::NeuriteBranchingEvent</a></div><div class="ttdoc">This event splits the current neurite element into two elements and adds a new side branch as daughte...</div><div class="ttdef"><b>Definition:</b> <a href="neurite__branching__event_8h_source.html#l00040">neurite_branching_event.h:40</a></div></div>
<div class="ttc" id="split__neurite__element__event_8h_html"><div class="ttname"><a href="split__neurite__element__event_8h.html">split_neurite_element_event.h</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_a7fa9dce9c4313fbfb1a638dca4fe5a44"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a7fa9dce9c4313fbfb1a638dca4fe5a44">bdm::experimental::neuroscience::NeuronNeuriteAdapter::OriginOf</a></div><div class="ttdeci">std::array&lt; double, 3 &gt; OriginOf(uint32_t daughter_element_idx) const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00102">neurite_element.h:102</a></div></div>
<div class="ttc" id="structbdm_1_1Math_html_abfb252b62698eaa4176ec9a83e89bf37"><div class="ttname"><a href="structbdm_1_1Math.html#abfb252b62698eaa4176ec9a83e89bf37">bdm::Math::CrossProduct</a></div><div class="ttdeci">static std::array&lt; double, N &gt; CrossProduct(const std::array&lt; double, N &gt; &amp;a, const std::array&lt; double, N &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="math__util_8h_source.html#l00130">math_util.h:130</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_ab30cf0c7801228cd9b62ac3a71e0fa67"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ab30cf0c7801228cd9b62ac3a71e0fa67">bdm::experimental::neuroscience::NeuriteElementExt::Bifurcate</a></div><div class="ttdeci">std::array&lt; MostDerivedSoPtr, 2 &gt; Bifurcate()</div><div class="ttdoc">Growth cone bifurcation. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00724">neurite_element.h:724</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a4b539af48347b27061a2b0aaee27812c"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a4b539af48347b27061a2b0aaee27812c">bdm::experimental::neuroscience::NeuriteElementExt::biology_modules_</a></div><div class="ttdeci">vec&lt; std::vector&lt; BiologyModules &gt; &gt; biology_modules_</div><div class="ttdoc">collection of biology modules which define the internal behavior </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01423">neurite_element.h:1423</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_aee4194da620ff39acfca04d6ccdc8029"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aee4194da620ff39acfca04d6ccdc8029">bdm::experimental::neuroscience::NeuriteElementExt::BranchPermitted</a></div><div class="ttdeci">bool BranchPermitted() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00608">neurite_element.h:608</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a84f1daf8ec532e814d0b6feedf59ad75"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a84f1daf8ec532e814d0b6feedf59ad75">bdm::experimental::neuroscience::NeuriteElementExt::NeuriteElementExt</a></div><div class="ttdeci">NeuriteElementExt(const NewNeuriteExtensionEvent &amp;event, TNeuronSoma *soma, uint64_t new_oid=0)</div><div class="ttdoc">This constructor is used to create a new neurite for a new neurite extension event. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00254">neurite_element.h:254</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a4a30f0cc6bf73ea6f43ec4566e8f6108"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a4a30f0cc6bf73ea6f43ec4566e8f6108">bdm::experimental::neuroscience::NeuriteElementExt::GetMother</a></div><div class="ttdeci">NeuriteOrNeuron GetMother()</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01257">neurite_element.h:1257</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a24a25778874592e4af2020f5e5a0d2a0"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a24a25778874592e4af2020f5e5a0d2a0">bdm::experimental::neuroscience::NeuriteElementExt::GetRequiredVisDataMembers</a></div><div class="ttdeci">static std::set&lt; std::string &gt; GetRequiredVisDataMembers()</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00233">neurite_element.h:233</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a933fd98f9bdc561fde5c3ce5fc9d70c0"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a933fd98f9bdc561fde5c3ce5fc9d70c0">bdm::experimental::neuroscience::NeuriteElementExt::GetAdherence</a></div><div class="ttdeci">double GetAdherence() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00469">neurite_element.h:469</a></div></div>
<div class="ttc" id="structbdm_1_1Math_html_af3e942d1d0f43968c73c7b8cbba2725d"><div class="ttname"><a href="structbdm_1_1Math.html#af3e942d1d0f43968c73c7b8cbba2725d">bdm::Math::Dot</a></div><div class="ttdeci">static T Dot(const std::array&lt; T, N &gt; &amp;a, const std::array&lt; T, N &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="math__util_8h_source.html#l00064">math_util.h:64</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_adece2f1e4e612e5748337fcde0f442bb"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#adece2f1e4e612e5748337fcde0f442bb">bdm::experimental::neuroscience::NeuronNeuriteAdapter::neurite_ptr_</a></div><div class="ttdeci">TNeuriteElementSoPtr neurite_ptr_</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00199">neurite_element.h:199</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a2b0613ab32a1dc9d6e96c50ff53b8205"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a2b0613ab32a1dc9d6e96c50ff53b8205">bdm::experimental::neuroscience::NeuriteElementExt::GetShape</a></div><div class="ttdeci">static constexpr Shape GetShape()</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00237">neurite_element.h:237</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html">bdm::experimental::neuroscience::NeuronNeuriteAdapter</a></div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00049">neurite_element.h:49</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a90d2a0570b35b1bfeae2f282b4d826b9"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a90d2a0570b35b1bfeae2f282b4d826b9">bdm::experimental::neuroscience::NeuriteElementExt::SetRestingLengthForDesiredTension</a></div><div class="ttdeci">void SetRestingLengthForDesiredTension(double tension)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00871">neurite_element.h:871</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_adc2ea69342c768dc688c7a5ea376567a"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#adc2ea69342c768dc688c7a5ea376567a">bdm::experimental::neuroscience::NeuriteElementExt::TransformCoordinatesPolarToLocal</a></div><div class="ttdeci">std::array&lt; double, 3 &gt; TransformCoordinatesPolarToLocal(const std::array&lt; double, 3 &gt; &amp;position) const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01222">neurite_element.h:1222</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_ae4542dab20ac7d818fa00f8ad345119c"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ae4542dab20ac7d818fa00f8ad345119c">bdm::experimental::neuroscience::NeuriteElementExt::GetBoxIdx</a></div><div class="ttdeci">uint64_t GetBoxIdx() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00493">neurite_element.h:493</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a7d64c264f1571f23dbf9c0bab7a37c5b"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a7d64c264f1571f23dbf9c0bab7a37c5b">bdm::experimental::neuroscience::NeuriteElementExt::GetZAxis</a></div><div class="ttdeci">const std::array&lt; double, 3 &gt; &amp; GetZAxis() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00475">neurite_element.h:475</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_ac35dc2737816d652cf8f6c15b482b293"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ac35dc2737816d652cf8f6c15b482b293">bdm::experimental::neuroscience::NeuriteElementExt::IsTerminal</a></div><div class="ttdeci">bool IsTerminal() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01327">neurite_element.h:1327</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_a0854c74881648c1a6dddfd5705afb125"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0854c74881648c1a6dddfd5705afb125">bdm::experimental::neuroscience::NeuronNeuriteAdapter::GetNeuronSomaSoPtr</a></div><div class="ttdeci">TNeuronSomaSoPtr &amp; GetNeuronSomaSoPtr()</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00089">neurite_element.h:89</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_ad9f2228c079b1fe0355637f354642e03"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ad9f2228c079b1fe0355637f354642e03">bdm::experimental::neuroscience::NeuriteElementExt::GetPositionPtr</a></div><div class="ttdeci">double * GetPositionPtr()</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00528">neurite_element.h:528</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a0e4ca0adcadf8411c5f393f269cb761f"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a0e4ca0adcadf8411c5f393f269cb761f">bdm::experimental::neuroscience::NeuriteElementExt::RemoveDaughter</a></div><div class="ttdeci">void RemoveDaughter(const MostDerivedSoPtr &amp;daughter)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00748">neurite_element.h:748</a></div></div>
<div class="ttc" id="simulation__object__util_8h_html_a6101b2c5b86a3594bbeaf078b35961f4"><div class="ttname"><a href="simulation__object__util_8h.html#a6101b2c5b86a3594bbeaf078b35961f4">BDM_SIM_OBJECT_HEADER</a></div><div class="ttdeci">#define BDM_SIM_OBJECT_HEADER(class_name, class_version_id,...)</div><div class="ttdef"><b>Definition:</b> <a href="simulation__object__util_8h_source.html#l00297">simulation_object_util.h:297</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_acab0dd47ad027a139541a431f9e2b184"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#acab0dd47ad027a139541a431f9e2b184">bdm::experimental::neuroscience::NeuronNeuriteAdapter::operator!=</a></div><div class="ttdeci">bool operator!=(const NeuronNeuriteAdapter&lt; TNeuronSomaSoPtr, TNeuriteElementSoPtr &gt; other) const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00191">neurite_element.h:191</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_afb2e0ba45705ceee528476c56db9a652"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#afb2e0ba45705ceee528476c56db9a652">bdm::experimental::neuroscience::NeuriteElementExt::GetDiameterPtr</a></div><div class="ttdeci">double * GetDiameterPtr()</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00529">neurite_element.h:529</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a35641e81dedc63e31e4ec29383d634bb"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a35641e81dedc63e31e4ec29383d634bb">bdm::experimental::neuroscience::NeuriteElementExt::UpdateReferences</a></div><div class="ttdeci">void UpdateReferences(const std::vector&lt; std::unordered_map&lt; uint32_t, uint32_t &gt;&gt; &amp;update_info)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00423">neurite_element.h:423</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a732af732906c4a1c9050c6dd2725ffaf"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a732af732906c4a1c9050c6dd2725ffaf">bdm::experimental::neuroscience::NeuriteElementExt::GetXAxis</a></div><div class="ttdeci">const std::array&lt; double, 3 &gt; &amp; GetXAxis() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00473">neurite_element.h:473</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a627db0b6763c4d4843ae7fb2695d957d"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a627db0b6763c4d4843ae7fb2695d957d">bdm::experimental::neuroscience::NeuriteElementExt::Branch</a></div><div class="ttdeci">MostDerivedSoPtr Branch(double diameter)</div><div class="ttdoc">Create a branch for this neurite element. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00641">neurite_element.h:641</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a50287c92165335f88ce50945e941a6c2"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a50287c92165335f88ce50945e941a6c2">bdm::experimental::neuroscience::NeuriteElementExt::GetNeuronSomaOfNeurite</a></div><div class="ttdeci">ToSoPtr&lt; NeuronSoma &gt; GetNeuronSomaOfNeurite() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00485">neurite_element.h:485</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a4817b3dce60fd516d4c1066d3c579e27"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a4817b3dce60fd516d4c1066d3c579e27">bdm::experimental::neuroscience::NeuriteElementExt::NeuriteElementExt</a></div><div class="ttdeci">NeuriteElementExt(const SplitNeuriteElementEvent &amp;event, TNeuriteElement *other, uint64_t new_oid=0)</div><div class="ttdoc">This constructor is used to create the proximal neurite element for a split neurite element event...</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00397">neurite_element.h:397</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a1ba633c65008a89b5297e1620dfe6986"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a1ba633c65008a89b5297e1620dfe6986">bdm::experimental::neuroscience::NeuriteElementExt::TransformCoordinatesLocalToGlobal</a></div><div class="ttdeci">std::array&lt; double, 3 &gt; TransformCoordinatesLocalToGlobal(const std::array&lt; double, 3 &gt; &amp;position) const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01196">neurite_element.h:1196</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_acd76dc3262056206791db0a0c3584c3a"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#acd76dc3262056206791db0a0c3584c3a">bdm::experimental::neuroscience::NeuriteElementExt::SetDensity</a></div><div class="ttdeci">void SetDensity(double density)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00448">neurite_element.h:448</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a061c427d08f461415aab8df011153ee7"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a061c427d08f461415aab8df011153ee7">bdm::experimental::neuroscience::NeuriteElementExt::TransformCoordinatesGlobalToPolar</a></div><div class="ttdeci">std::array&lt; double, 3 &gt; TransformCoordinatesGlobalToPolar(const std::array&lt; double, 3 &gt; &amp;position) const </div><div class="ttdoc">G -&gt; L : G -&gt; L, then L -&gt; P. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01241">neurite_element.h:1241</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_a8f653135ca75fab17dbd966cb83a4a75"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a8f653135ca75fab17dbd966cb83a4a75">bdm::experimental::neuroscience::NeuronNeuriteAdapter::NeuronNeuriteAdapter</a></div><div class="ttdeci">NeuronNeuriteAdapter(T &amp;&amp;soptr, typename std::enable_if&lt; is_same&lt; T, TNeuronSomaSoPtr &gt;::value &gt;::type *p=0)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00056">neurite_element.h:56</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_afef33b19ea3f8c043f03605f9ebfa0d3"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#afef33b19ea3f8c043f03605f9ebfa0d3">bdm::experimental::neuroscience::NeuriteElementExt::OriginOf</a></div><div class="ttdeci">std::array&lt; double, 3 &gt; OriginOf(uint32_t daughter_element_idx) const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00501">neurite_element.h:501</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_ac15587feb42d266325374dfc32f2b5b6"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ac15587feb42d266325374dfc32f2b5b6">bdm::experimental::neuroscience::NeuriteElementExt::Branch</a></div><div class="ttdeci">MostDerivedSoPtr Branch()</div><div class="ttdoc">Create a branch for this neurite element. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00656">neurite_element.h:656</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a6d1cbfd883b7127ecc71639c9a131470"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a6d1cbfd883b7127ecc71639c9a131470">bdm::experimental::neuroscience::NeuriteElementExt::ApplyDisplacement</a></div><div class="ttdeci">void ApplyDisplacement(const std::array&lt; double, 3 &gt; &amp;displacement)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01089">neurite_element.h:1089</a></div></div>
<div class="ttc" id="random_8h_html"><div class="ttname"><a href="random_8h.html">random.h</a></div></div>
<div class="ttc" id="structbdm_1_1Math_html_a9b542109de827309660950e8f5dee515"><div class="ttname"><a href="structbdm_1_1Math.html#a9b542109de827309660950e8f5dee515">bdm::Math::ProjectionOnto</a></div><div class="ttdeci">static std::array&lt; double, 3 &gt; ProjectionOnto(const std::array&lt; double, 3 &gt; &amp;a, const std::array&lt; double, 3 &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="math__util_8h_source.html#l00199">math_util.h:199</a></div></div>
<div class="ttc" id="shape_8h_html"><div class="ttname"><a href="shape_8h.html">shape.h</a></div></div>
<div class="ttc" id="structbdm_1_1Math_html_a7f1e8761aa38ac6cb93d35bfa1ad2d26"><div class="ttname"><a href="structbdm_1_1Math.html#a7f1e8761aa38ac6cb93d35bfa1ad2d26">bdm::Math::Norm</a></div><div class="ttdeci">static double Norm(const std::array&lt; double, 3 &gt; &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="math__util_8h_source.html#l00095">math_util.h:95</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_ae3fabe33f31d680ca046de2065b68a49"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#ae3fabe33f31d680ca046de2065b68a49">bdm::experimental::neuroscience::NeuriteElementExt::GetPosition</a></div><div class="ttdeci">const std::array&lt; double, 3 &gt; GetPosition() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00450">neurite_element.h:450</a></div></div>
<div class="ttc" id="log_8h_html"><div class="ttname"><a href="log_8h.html">log.h</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a7081cfee876b7518053dd39948ce1298"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a7081cfee876b7518053dd39948ce1298">bdm::experimental::neuroscience::NeuriteElementExt::GetUnitaryAxisDirectionVector</a></div><div class="ttdeci">std::array&lt; double, 3 &gt; GetUnitaryAxisDirectionVector() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01320">neurite_element.h:1320</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_a0d243d8c61c7c199f25bee0e217c4bdf"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a0d243d8c61c7c199f25bee0e217c4bdf">bdm::experimental::neuroscience::NeuronNeuriteAdapter::GetNeuronSomaSoPtr</a></div><div class="ttdeci">const TNeuronSomaSoPtr &amp; GetNeuronSomaSoPtr() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00083">neurite_element.h:83</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a2820beb162a49235208a018bbf49b521"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a2820beb162a49235208a018bbf49b521">bdm::experimental::neuroscience::NeuriteElementExt::TransformCoordinatesGlobalToLocal</a></div><div class="ttdeci">std::array&lt; double, 3 &gt; TransformCoordinatesGlobalToLocal(const std::array&lt; double, 3 &gt; &amp;position) const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01184">neurite_element.h:1184</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_a3e9c79802e9f3aec60e79cf1b6eb303e"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#a3e9c79802e9f3aec60e79cf1b6eb303e">bdm::experimental::neuroscience::NeuronNeuriteAdapter::operator==</a></div><div class="ttdeci">bool operator==(const NeuronNeuriteAdapter&lt; TNeuronSomaSoPtr, TNeuriteElementSoPtr &gt; other) const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00184">neurite_element.h:184</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a419ad84dfb134ea3b39ba3a8ea9a34d2"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a419ad84dfb134ea3b39ba3a8ea9a34d2">bdm::experimental::neuroscience::NeuriteElementExt::vec</a></div><div class="ttdeci">typename Backend::template vec&lt; T &gt; vec</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00222">neurite_element.h:222</a></div></div>
<div class="ttc" id="namespacebdm_html_a3037f55bcb7f13fc1580dfb578dec3eea3069b5d7175aff08def5caa5266f8055"><div class="ttname"><a href="namespacebdm.html#a3037f55bcb7f13fc1580dfb578dec3eea3069b5d7175aff08def5caa5266f8055">bdm::kCylinder</a></div><div class="ttdef"><b>Definition:</b> <a href="shape_8h_source.html#l00020">shape.h:20</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_aa74bdf2edb57bbcc68dc1450d6625bd2"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa74bdf2edb57bbcc68dc1450d6625bd2">bdm::experimental::neuroscience::NeuriteElementExt::SetSpringConstant</a></div><div class="ttdeci">void SetSpringConstant(double spring_constant)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01309">neurite_element.h:1309</a></div></div>
<div class="ttc" id="structbdm_1_1Math_html_a0295284d54dc8b78b7d981fefe373889"><div class="ttname"><a href="structbdm_1_1Math.html#a0295284d54dc8b78b7d981fefe373889">bdm::Math::Perp3</a></div><div class="ttdeci">static std::array&lt; double, 3 &gt; Perp3(const std::array&lt; double, 3 &gt; &amp;a, double random)</div><div class="ttdef"><b>Definition:</b> <a href="math__util_8h_source.html#l00144">math_util.h:144</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_aa0e661c70c491f8eb0d532e69239c911"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#aa0e661c70c491f8eb0d532e69239c911">bdm::experimental::neuroscience::NeuriteElementExt::NeuronSoma</a></div><div class="ttdeci">typename TCompileTimeParam::NeuronSoma NeuronSoma</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00225">neurite_element.h:225</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a94834ee0cb2248fe8da785c991564b55"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a94834ee0cb2248fe8da785c991564b55">bdm::experimental::neuroscience::NeuriteElementExt::GetTension</a></div><div class="ttdeci">double GetTension() const </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01313">neurite_element.h:1313</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter_html_ac4ebc1b8d47e2e672e6e977b640b477e"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuronNeuriteAdapter.html#ac4ebc1b8d47e2e672e6e977b640b477e">bdm::experimental::neuroscience::NeuronNeuriteAdapter::RemoveDaughter</a></div><div class="ttdeci">void RemoveDaughter(const TNeuriteElementSoPtr &amp;mother)</div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l00174">neurite_element.h:174</a></div></div>
<div class="ttc" id="math__util_8h_html"><div class="ttname"><a href="math__util_8h.html">math_util.h</a></div></div>
<div class="ttc" id="default__force_8h_html"><div class="ttname"><a href="default__force_8h.html">default_force.h</a></div></div>
<div class="ttc" id="classbdm_1_1SoPointer_html"><div class="ttname"><a href="classbdm_1_1SoPointer.html">bdm::SoPointer</a></div><div class="ttdef"><b>Definition:</b> <a href="so__pointer_8h_source.html#l00041">so_pointer.h:41</a></div></div>
<div class="ttc" id="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt_html_a9ad736863fa0e984d7e5e77b4c98a2ef"><div class="ttname"><a href="classbdm_1_1experimental_1_1neuroscience_1_1NeuriteElementExt.html#a9ad736863fa0e984d7e5e77b4c98a2ef">bdm::experimental::neuroscience::NeuriteElementExt::ExtendSideNeuriteElement</a></div><div class="ttdeci">MostDerivedSoPtr ExtendSideNeuriteElement(double length, double diameter, const std::array&lt; double, 3 &gt; &amp;direction)</div><div class="ttdoc">Extend a side neurite element and assign it to daughter right. </div><div class="ttdef"><b>Definition:</b> <a href="neurite__element_8h_source.html#l01642">neurite_element.h:1642</a></div></div>
<div class="ttc" id="structbdm_1_1experimental_1_1neuroscience_1_1NewNeuriteExtensionEvent_html"><div class="ttname"><a href="structbdm_1_1experimental_1_1neuroscience_1_1NewNeuriteExtensionEvent.html">bdm::experimental::neuroscience::NewNeuriteExtensionEvent</a></div><div class="ttdoc">Contains the parameters to extend a new neurite from a neuron soma. </div><div class="ttdef"><b>Definition:</b> <a href="new__neurite__extension__event_8h_source.html#l00035">new_neurite_extension_event.h:35</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_19355cc319126bb51dcdac43ee2050e0.html">neuroscience</a></li><li class="navelem"><a class="el" href="neurite__element_8h.html">neurite_element.h</a></li>
    <li class="footer">Generated on Tue Oct 9 2018 12:41:31 for BioDynaMo by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
